<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<title>
  
    Design Patterns for Web-Developer &middot; Bootstrap
  
</title>

<!-- Bootstrap core CSS -->
<link href="./assets/css/bootstrap.css" rel="stylesheet">


<!-- Documentation extras -->
<link href="./assets/css/docs.css" rel="stylesheet">
<link href="./assets/css/pygments-manni.css" rel="stylesheet">


<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="./assets/js/html5shiv.js"></script>
  <script src="./assets/js/respond/respond.min.js"></script>
<![endif]-->

<!-- Favicons -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="./assets/ico/apple-touch-icon-144-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="./assets/ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./assets/ico/apple-touch-icon-72-precomposed.png">
                <link rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-57-precomposed.png">
                               <link rel="shortcut icon" href="./assets/ico/favicon.png">

    <!-- Place anything custom after this. -->
  </head>
  <body class="bs-docs-docs" data-spy="scroll" data-target=".bs-docs-sidebar">

    <!-- Docs nav -->
    <div class="bs-docs-sidebar">
<ul class="nav bs-docs-sidenav">
<h3 class="bs-docs-sidenav-heading"><a href="/">Design Patterns for Web-Developer</a></h3>
<li><a href="#">Object Creational</a>
<ul class="nav">
<li><a href="#object-creational-abstract-factory">Abstract Factory</a></li>
<li><a href="#object-creational-builder">Builder</a></li>
<li><a href="#object-creational-prototype">Prototype</a></li>
<li><a href="#object-creational-singleton">Singleton</a></li>
</ul><li><a href="#">Object Structural</a>
<ul class="nav">
<li><a href="#object-structural-bridge">Bridge</a></li>
<li><a href="#object-structural-decorator">Decorator</a></li>
<li><a href="#object-structural-flyweight">Flyweight</a></li>
</ul></ul>
</div>


    <!-- Page content of course! -->
    <div class="bs-docs-container">
    <h2 class="bs-docs-section" id="object-creational-abstract-factory">Abstract Factory</h2>

<blockquote cite="http://www.goodreads.com/book/show/85009.Design_Patterns">
<p>
Provide an interface for creating families of related or dependent objects without specifying their concrete classes.
</p>
<footer>â€”  <cite><a title="Gamma, Erich; Helm, Richard; Johnson, Ralph; Vlissides, John (1994-10-31). Design Patterns: Elements of Reusable Object-Oriented Software" href="http://www.goodreads.com/book/show/85009.Design_Patterns">Gang of Four</a></cite></footer>
</blockquote>

<p><img src="./assets/img/AbstractFactory/uml.png" alt="Abstract Factory pattern class diagram" /></p>

<p>The pattern allows:</p>

<ul>
  <li>the system to be independent of how its products are created, composed, and represented;</li>
  <li>to use families of objects together;</li>
  <li>to decouple concrete class from the clients;</li>
  <li>run-time control over object creation process.</li>
</ul>

<p>Abstract factory declares an interface to be implemented by every concrete factory responsible
for creation of product objects (usually belonging to a family). So the client using
concrete factories is isolated from implementation classes. Client doesn&#8217;t know product class names; that&#8217;s responsibility
of a concrete factory. The pattern also makes it easy to switch between product families. Since concrete factories
implement the same interface, simply change of the concrete factory on the client will bring to a different product family.</p>

<p>AbstractFactory classes are often implemented with factory methods ({var|Factory Method}),
but they can also be implemented via Prototype.</p>

<p>A concrete factory is usually designed as a <a href="#Singleton">Singleton</a>.</p>

<h3 id="php-example">PHP Example</h3>

<p>Let&#8217;s imagine we are required to build a UI, which is represented differently depending on the configuration.
If the page is requested on a desktop PC it uses jQuery UI framework. If it&#8217;s on a mobile device - jQuery Mobile.
In this example we have two interfaces <var>\Widget\Button\iButton</var> and <var>\Widget\Dialog\iDialog</var> and
implementations of those for desktop PC and mobile devices. To create a widget object we use factories: <var>Widget\Factory\Desktop</var> and
<var>Widget\Factory\Mobile</var>. Thus the client (<var>\Application</var>) picks out the required factory (here based on passed in configuration object)
and further deals with interfaces, not concrete implementations.
As soon as configuration changed (e.g according user agent) the application gets widgets represented respectevly</p>

<p><img src="./assets/img/AbstractFactory/PHP/uml.png" alt="Abstract Factory pattern PHP example class diagram" /></p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package AbstractFactory Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>


<span class="c1">// File: ./Application.php</span>

<span class="c1">// Client</span>
<span class="k">class</span> <span class="nc">Application</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$_config</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$config</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_config</span> <span class="o">=</span> <span class="nv">$config</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">_createPlaformSpecificFactory</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$className</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">Widget</span><span class="se">\\</span><span class="s2">Factory</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nx">ucfirst</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_config</span><span class="o">-&gt;</span><span class="na">platform</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nv">$className</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">build</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$factory</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_createPlaformSpecificFactory</span><span class="p">();</span>
        <span class="nv">$dialog</span> <span class="o">=</span> <span class="nv">$factory</span><span class="o">-&gt;</span><span class="na">makeDialog</span><span class="p">();</span>
        <span class="nv">$dialog</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>
        <span class="nv">$button</span> <span class="o">=</span> <span class="nv">$factory</span><span class="o">-&gt;</span><span class="na">makeButton</span><span class="p">();</span>
        <span class="nv">$button</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// File: ./Config.php</span>

<span class="c1">// Object specifiers</span>
<span class="k">class</span> <span class="nc">Config</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$platform</span><span class="p">;</span>
<span class="p">}</span>


<span class="c1">// File: ./Widget/Button/Desktop.php</span>

<span class="k">namespace</span> <span class="nx">Widget\Button</span><span class="p">;</span>

<span class="c1">// Concrete Product</span>
<span class="k">class</span> <span class="nc">Desktop</span> <span class="k">implements</span> <span class="nx">\Widget\Button\iButton</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">print</span> <span class="s2">&quot;jQueryUI based button&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Button/iButton.php</span>
<span class="k">namespace</span> <span class="nx">Widget\Button</span><span class="p">;</span>

<span class="c1">// Abstract Product</span>
<span class="k">interface</span> <span class="nx">iButton</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Button/Mobile.php</span>

<span class="k">namespace</span> <span class="nx">Widget\Button</span><span class="p">;</span>

<span class="c1">// Concrete Product</span>
<span class="k">class</span> <span class="nc">Mobile</span> <span class="k">implements</span> <span class="nx">\Widget\Button\iButton</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">print</span> <span class="s2">&quot;jQueryMobile based button&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Dialog/Desktop.php</span>
<span class="k">namespace</span> <span class="nx">Widget\Dialog</span><span class="p">;</span>

<span class="c1">// Concrete Product</span>
<span class="k">class</span> <span class="nc">Desktop</span> <span class="k">implements</span> <span class="nx">\Widget\Dialog\iDialog</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">print</span> <span class="s2">&quot;jQueryUI based dialog&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Dialog/iDialog.php</span>

<span class="k">namespace</span> <span class="nx">Widget\Dialog</span><span class="p">;</span>

<span class="c1">// Abstract Product</span>
<span class="k">interface</span> <span class="nx">iDialog</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Dialog/Mobile.php</span>

<span class="k">namespace</span> <span class="nx">Widget\Dialog</span><span class="p">;</span>

<span class="c1">// Concrete Product</span>
<span class="k">class</span> <span class="nc">Mobile</span> <span class="k">implements</span> <span class="nx">\Widget\Dialog\iDialog</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">print</span> <span class="s2">&quot;jQueryMobile based dialog&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Factory/AbstractFactory.php</span>

<span class="k">namespace</span> <span class="nx">Widget\Factory</span><span class="p">;</span>

<span class="c1">// Abstract Factory</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">AbstractFactory</span>
<span class="p">{</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">makeDialog</span><span class="p">();</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">makeButton</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Factory/Desktop.php</span>

<span class="k">namespace</span> <span class="nx">Widget\Factory</span><span class="p">;</span>

<span class="c1">// Concrete Factory</span>
<span class="k">class</span> <span class="nc">Desktop</span> <span class="k">extends</span> <span class="nx">AbstractFactory</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">makeDialog</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">\Widget\Dialog\Desktop</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">makeButton</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">\Widget\Button\Desktop</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Factory/Mobile.php</span>

<span class="k">namespace</span> <span class="nx">Widget\Factory</span><span class="p">;</span>

<span class="c1">// Concrete Factory</span>
<span class="k">class</span> <span class="nc">Mobile</span> <span class="k">extends</span> <span class="nx">AbstractFactory</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">makeDialog</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">\Widget\Dialog\Mobile</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">makeButton</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">\Widget\Button\Mobile</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//File: example.php</span>

<span class="sd">/**</span>
<span class="sd"> * Usage</span>
<span class="sd"> */</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Factory/AbstractFactory.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Factory/Desktop.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Factory/Mobile.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Dialog/iDialog.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Dialog/Desktop.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Dialog/Mobile.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Button/iButton.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Button/Desktop.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Button/Mobile.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Config.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Application.php&quot;</span><span class="p">;</span>

<span class="nv">$config</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Config</span><span class="p">();</span>
<span class="nv">$config</span><span class="o">-&gt;</span><span class="na">platform</span> <span class="o">=</span> <span class="s2">&quot;mobile&quot;</span><span class="p">;</span>
<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">(</span><span class="nv">$config</span><span class="p">);</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">build</span><span class="p">();</span>

<span class="cm">/*</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// jQueryMobile based dialog</span>
<span class="c1">// jQueryMobile based button</span>
</code></pre></div>

<h3 id="javascript-example">JavaScript Example</h3>

<p>Here we solve the same task as above: the application builds widgets based on supplied configuration. Although in here
we either get real widgets or mock ones for unit-testing.
We will use <var>Object.create</var> to extend abstract objects.</p>

<p><img src="./assets/img/AbstractFactory/EcmaScript/uml.png" alt="Abstract Factory pattern EcmaScript example class diagram" /></p>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package AbstractFactory Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>

<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false */</span>
    
     <span class="c1">// Abstract product</span>
<span class="kd">var</span> <span class="nx">AbstractWidget</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">},</span>
    
    <span class="c1">// Concrete product</span>
    <span class="nx">carousel</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractWidget</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">render</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Carousel widget rendered&#39;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}),</span>
    <span class="c1">// Concrete product</span>
    <span class="nx">mockCarousel</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractWidget</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">render</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Mock carousel widget rendered&#39;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}),</span>
    
    <span class="c1">// Abstract factory</span>
    <span class="nx">AbstractWidgetFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="c1">// Concrete factory</span>
    <span class="nx">mockWidgetFactory</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractWidgetFactory</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">makeCarousel</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">mockCarousel</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}),</span>
    <span class="c1">// Concrete factory</span>
    <span class="nx">widgetFactory</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractWidgetFactory</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">makeCarousel</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">carousel</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}),</span>
   
    <span class="c1">// Client</span>
    <span class="nx">page</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">widget</span><span class="p">,</span>
                    <span class="nx">factory</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">options</span><span class="p">.</span><span class="nx">testing</span> <span class="o">?</span> <span class="nx">mockWidgetFactory</span> <span class="o">:</span> <span class="nx">widgetFactory</span> <span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span> <span class="nx">factory</span> <span class="k">instanceof</span> <span class="nx">AbstractWidgetFactory</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="s2">&quot;Argument must be an instance of AbstractWidgetFactory&quot;</span> <span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">widget</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">.</span><span class="nx">makeCarousel</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">widget</span> <span class="k">instanceof</span> <span class="nx">AbstractWidget</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="s2">&quot;Argument must be an instance of AbstractWidget&quot;</span> <span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">widget</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">}());</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
<span class="nx">page</span><span class="p">.</span><span class="nx">render</span><span class="p">({</span> <span class="s2">&quot;testing&quot;</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>
<span class="nx">page</span><span class="p">.</span><span class="nx">render</span><span class="p">({</span> <span class="s2">&quot;testing&quot;</span><span class="o">:</span> <span class="kc">false</span> <span class="p">});</span>

<span class="c1">// Output</span>
<span class="c1">// Mock carousel widget rendered</span>
<span class="c1">// Carousel widget rendered</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="jsa-example">JSA Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package AbstractFactory Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>

<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false, require:false */</span>
    
<span class="kd">var</span> <span class="nx">jsa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../../../vendors/jsa/jsa.umd&quot;</span><span class="p">),</span>
    <span class="c1">// Client</span>
    <span class="nx">PageClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">widget</span><span class="p">,</span>
                    <span class="nx">factory</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">options</span><span class="p">.</span><span class="nx">testing</span> <span class="o">?</span>
                        <span class="nx">MockWidgetFactory</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">()</span> <span class="o">:</span> 
                        <span class="nx">WidgetFactory</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">()</span> <span class="p">);</span>

                <span class="nx">widget</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">.</span><span class="nx">makeCarousel</span><span class="p">();</span>
                <span class="nx">widget</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Abstract factory</span>
    <span class="nx">AbstractWidgetFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="c1">// Concrete factory</span>
    <span class="nx">MockWidgetFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">AbstractWidgetFactory</span><span class="p">,</span>
            <span class="nx">makeCarousel</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">MockCarousel</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Concrete factory</span>
    <span class="nx">WidgetFactory</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">AbstractWidgetFactory</span><span class="p">,</span>
            <span class="nx">makeCarousel</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">Carousel</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    
    
    
    <span class="c1">// Abstract product</span>
    <span class="nx">AbstractWidget</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="nx">Carousel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">AbstractWidget</span><span class="p">,</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Carousel widget rendered&#39;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="nx">MockCarousel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">AbstractWidget</span><span class="p">,</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Mock carousel widget rendered&#39;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
<span class="nx">PageClass</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">({</span> <span class="s2">&quot;testing&quot;</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}).</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">PageClass</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">({</span> <span class="s2">&quot;testing&quot;</span><span class="o">:</span> <span class="kc">false</span> <span class="p">}).</span><span class="nx">render</span><span class="p">();</span>

<span class="c1">// Output</span>
<span class="c1">// Mock carousel widget rendered</span>
<span class="c1">// Carousel widget rendered</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="typescript-example">TypeScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package AbstractFactory Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">console</span><span class="p">;</span>

<span class="nx">module</span> <span class="nx">Widget</span>
<span class="p">{</span>
    <span class="c1">// Abstract product</span>
    <span class="kr">export</span> <span class="kr">interface</span> <span class="nx">AbstractWidget</span>
    <span class="p">{</span>
        <span class="nx">render</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Concrete product</span>
    <span class="kr">export</span> <span class="kr">class</span> <span class="nx">Carousel</span>
    <span class="p">{</span>
        <span class="kr">public</span> <span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Carousel widget rendered&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Concrete product</span>
    <span class="kr">export</span> <span class="kr">class</span> <span class="nx">MockCarousel</span>
    <span class="p">{</span>
        <span class="kr">public</span> <span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Mock carousel widget rendered&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="nx">module</span> <span class="nx">WidgetFactory</span>
<span class="p">{</span>
    <span class="c1">// Abstract factory</span>
    <span class="kr">export</span> <span class="kr">interface</span> <span class="nx">AbstractFactory</span>
    <span class="p">{</span>
        <span class="nx">makeCarousel</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">Widget</span><span class="p">.</span><span class="nx">AbstractWidget</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Concrete factory</span>
    <span class="kr">export</span> <span class="kr">class</span> <span class="nx">Mock</span>
    <span class="p">{</span>
        <span class="kr">public</span> <span class="nx">makeCarousel</span><span class="p">()</span><span class="o">:</span> <span class="nx">Widget</span><span class="p">.</span><span class="nx">AbstractWidget</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">Widget</span><span class="p">.</span><span class="nx">MockCarousel</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Concrete factory</span>
    <span class="kr">export</span> <span class="kr">class</span> <span class="nx">Regular</span>
    <span class="p">{</span>
        <span class="kr">public</span> <span class="nx">makeCarousel</span><span class="p">()</span><span class="o">:</span> <span class="nx">Widget</span><span class="p">.</span><span class="nx">AbstractWidget</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">Widget</span><span class="p">.</span><span class="nx">Carousel</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Abstraction for configuration object</span>
<span class="kr">interface</span> <span class="nx">PageOptions</span>
<span class="p">{</span>
    <span class="nx">testing</span><span class="o">:</span> <span class="nx">bool</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Client</span>
<span class="kr">class</span> <span class="nx">Page</span>
<span class="p">{</span>
    <span class="kr">private</span> <span class="nx">options</span><span class="o">:</span> <span class="nx">PageOptions</span><span class="p">;</span>

    <span class="nx">constructor</span><span class="p">(</span> <span class="nx">options</span><span class="o">:</span> <span class="nx">PageOptions</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">widget</span><span class="o">:</span> <span class="nx">Widget</span><span class="p">.</span><span class="nx">AbstractWidget</span><span class="p">,</span>
            <span class="nx">factory</span><span class="o">:</span> <span class="nx">WidgetFactory</span><span class="p">.</span><span class="nx">AbstractFactory</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">testing</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WidgetFactory</span><span class="p">.</span><span class="nx">Mock</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WidgetFactory</span><span class="p">.</span><span class="nx">Regular</span><span class="p">();</span>
        <span class="p">}</span>
        
        <span class="nx">widget</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">.</span><span class="nx">makeCarousel</span><span class="p">();</span>
        <span class="nx">widget</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="kd">var</span> <span class="nx">testPage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Page</span><span class="p">({</span> <span class="s2">&quot;testing&quot;</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}),</span>
    <span class="nx">page</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Page</span><span class="p">({</span> <span class="s2">&quot;testing&quot;</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>

<span class="nx">testPage</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">page</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>


<span class="c1">// Output</span>
<span class="c1">// Mock carousel widget rendered</span>
<span class="c1">// Carousel widget rendered</span>
</code></pre></div>

<h2 class="bs-docs-section" id="object-creational-builder">Builder</h2>

<blockquote cite="http://www.goodreads.com/book/show/85009.Design_Patterns">
<p>
Separate the construction of a complex object from its representation so that the same construction process can create different representations.
</p>
<footer>â€”  <cite><a title="Gamma, Erich; Helm, Richard; Johnson, Ralph; Vlissides, John (1994-10-31). Design Patterns: Elements of Reusable Object-Oriented Software" href="http://www.goodreads.com/book/show/85009.Design_Patterns">Gang of Four</a></cite></footer>
</blockquote>

<p><img src="./assets/img/Builder/uml.png" alt="Builder pattern class diagram" /></p>

<p>The pattern allows:</p>

<ul>
  <li>decoupling construction of complex objects from the module;</li>
  <li>multiple representations of object construction algorithm;</li>
  <li>run-time control over object construction process;</li>
  <li>an application design abstraction where one object acts as a Director and other as subordinated Builders.</li>
</ul>

<h3 id="php-example-1">PHP Example</h3>

<p>Imagine that we have an object consisting of many parts which we
need to re-build into a new one so, that its parts had different representations.
For instance we work on a text convertor which is expected to process
properly all the parts of the original document. In following example you can
find Builder (<var>AbstractConvertor</var>) object with all the methods to convert every
property of the initial document (Author, Title, Chapter).
Concrete Builders <var>Epub</var> and <var>Pdf</var> implement Builder interface
for the responsive text formats. The Director (<var>Reader</var>) constructs
a new object (Product) from a given initial document (<var>Entity</var>) and using a Concrete Builder.</p>

<p><img src="./assets/img/Builder/PHP/uml.png" alt="Builder pattern PHP example class diagram" /></p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Builder Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>


<span class="c1">// File: ./Document/Reader.php</span>
<span class="k">namespace</span> <span class="nx">Document</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Reader</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getDocument</span><span class="p">(</span><span class="nx">\Document\Entity</span> <span class="nv">$document</span>
        <span class="p">,</span> <span class="nx">\Document\AbstractConvertor</span> <span class="nv">$convertor</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$convertor</span><span class="o">-&gt;</span><span class="na">setAuthor</span><span class="p">(</span><span class="nv">$document</span><span class="o">-&gt;</span><span class="na">author</span><span class="p">);</span>
        <span class="nv">$convertor</span><span class="o">-&gt;</span><span class="na">setTitle</span><span class="p">(</span><span class="nv">$document</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$document</span><span class="o">-&gt;</span><span class="na">chapters</span> <span class="k">as</span> <span class="nv">$chapter</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$convertor</span><span class="o">-&gt;</span><span class="na">setText</span><span class="p">(</span><span class="nv">$chapter</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nv">$convertor</span><span class="o">-&gt;</span><span class="na">getDocument</span><span class="p">();</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="c1">// File: ./Document/Convertor/Epub.php</span>
<span class="k">namespace</span> <span class="nx">Document\Convertor</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Epub</span> <span class="k">extends</span> <span class="nx">\Document\AbstractConvertor</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setAuthor</span><span class="p">(</span><span class="nv">$author</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buffer</span> <span class="o">.=</span> <span class="s2">&quot;ePub: Author info </span><span class="si">{</span><span class="nv">$author</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTitle</span><span class="p">(</span><span class="nv">$title</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buffer</span> <span class="o">.=</span> <span class="s2">&quot;ePub: Title info </span><span class="si">{</span><span class="nv">$title</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setText</span><span class="p">(</span><span class="nv">$text</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buffer</span> <span class="o">.=</span> <span class="s2">&quot;ePub: </span><span class="si">{</span><span class="nv">$text</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Document/Convertor/Pdf.php</span>
<span class="k">namespace</span> <span class="nx">Document\Convertor</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Pdf</span> <span class="k">extends</span> <span class="nx">\Document\AbstractConvertor</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setAuthor</span><span class="p">(</span><span class="nv">$author</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buffer</span> <span class="o">.=</span> <span class="s2">&quot;PDF: Author info </span><span class="si">{</span><span class="nv">$author</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTitle</span><span class="p">(</span><span class="nv">$title</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buffer</span> <span class="o">.=</span> <span class="s2">&quot;PDF: Title info </span><span class="si">{</span><span class="nv">$title</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setText</span><span class="p">(</span><span class="nv">$text</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buffer</span> <span class="o">.=</span> <span class="s2">&quot;PDF: </span><span class="si">{</span><span class="nv">$text</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="c1">// File: ./Document/AbstractConvertor.php</span>
<span class="k">namespace</span> <span class="nx">Document</span><span class="p">;</span>

<span class="k">abstract</span> <span class="k">class</span> <span class="nc">AbstractConvertor</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$_buffer</span><span class="p">;</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">setAuthor</span><span class="p">(</span><span class="nv">$author</span><span class="p">);</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">setTitle</span><span class="p">(</span><span class="nv">$title</span><span class="p">);</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">setText</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getDocument</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buffer</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// File: ./Document/Entity.php</span>
<span class="k">namespace</span> <span class="nx">Document</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Entity</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$author</span> <span class="o">=</span> <span class="s2">&quot;George R. R. Martin&quot;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$title</span> <span class="o">=</span> <span class="s2">&quot;The Song of Ice and Fire&quot;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$chapters</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Chapter 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Chapter 2&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//File: example.php</span>
<span class="k">include</span> <span class="s1">&#39;./Document/Entity.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;./Document/Reader.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;./Document/AbstractConvertor.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;./Document/Convertor/Pdf.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;./Document/Convertor/Epub.php&#39;</span><span class="p">;</span>

<span class="c1">// Usage example</span>

<span class="nv">$doc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Document\Entity</span><span class="p">();</span>
<span class="nv">$convertor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Document\Convertor\Pdf</span><span class="p">();</span>
<span class="nv">$reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Document\Reader</span><span class="p">();</span>
<span class="k">print</span> <span class="nv">$reader</span><span class="o">-&gt;</span><span class="na">getDocument</span><span class="p">(</span><span class="nv">$doc</span><span class="p">,</span> <span class="nv">$convertor</span><span class="p">);</span>
</code></pre></div>

<h3 id="javascript-example-1">JavaScript Example</h3>

<p>In EcmaScript example we use Director (<var>moduleManager</var>) to build a widget based
on a supplied configuration and using a given Concrete Builder (<var>ThemeA</var>).
Thus if configuration changes toward an other theme, it&#8217;s going to be transparent
for the client application.</p>

<p><img src="./assets/img/Builder/EcmaScript/uml.png" alt="Builder pattern EcmaScript example class diagram" /></p>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Builder Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false */</span>

    <span class="c1">// Widget is used to build a product</span>
<span class="kd">var</span> <span class="nx">AbstractWidget</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="nx">mockWidget</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractWidget</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">render</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="s2">&quot;The module has widget&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}),</span>
    <span class="c1">// Concrete product</span>
    <span class="nx">module</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
    <span class="c1">// Director</span>
    <span class="nx">moduleManager</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">_options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nx">widget</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nx">isClosable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">isResizable</span><span class="o">:</span> <span class="kc">false</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">_options</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">construct</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">builder</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">builder</span> <span class="k">instanceof</span> <span class="nx">AbstractBuilder</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="s2">&quot;Argument must be an instance of AbstractBuilder&quot;</span> <span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">builder</span><span class="p">.</span><span class="nx">buildWindow</span><span class="p">(</span> <span class="nx">_options</span><span class="p">.</span><span class="nx">title</span> <span class="p">);</span>
                <span class="nx">_options</span><span class="p">.</span><span class="nx">widget</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachWidget</span><span class="p">(</span> <span class="nx">_options</span><span class="p">.</span><span class="nx">widget</span> <span class="p">);</span>
                <span class="nx">_options</span><span class="p">.</span><span class="nx">isClosable</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachCloseButton</span><span class="p">();</span>
                <span class="nx">_options</span><span class="p">.</span><span class="nx">isResizable</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachResizeControl</span><span class="p">();</span>
                <span class="k">return</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">getModule</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">}()),</span>
    <span class="c1">// Abstract builder</span>
    <span class="nx">AbstractBuilder</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="c1">// Concrete builder</span>
    <span class="nx">themeA</span><span class="p">;</span>
    <span class="c1">// Members to be inherited by every theme</span>
    <span class="nx">AbstractBuilder</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">markup</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nx">getModule</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">markup</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">themeA</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractBuilder</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">buildWindow</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">title</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;Module &quot;</span> <span class="o">+</span> <span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot; represented with ThemeA theme\n&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">attachCloseButton</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;The module has close button\n&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">attachWidget</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">widget</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="nx">widget</span> <span class="k">instanceof</span> <span class="nx">AbstractWidget</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="s2">&quot;Argument must be an instance of AbstractWidget&quot;</span> <span class="p">);</span>
                <span class="p">}</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="nx">widget</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">attachResizeControl</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;The module has resize control\n&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
    <span class="nx">moduleManager</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Example&quot;</span><span class="p">,</span>
        <span class="nx">widget</span><span class="o">:</span> <span class="nx">mockWidget</span><span class="p">,</span>
        <span class="nx">isClosable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">isResizable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>

    <span class="nx">module</span> <span class="o">=</span> <span class="nx">moduleManager</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span> <span class="nx">themeA</span> <span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">module</span> <span class="p">);</span>

<span class="c1">// Output</span>
<span class="c1">// Module Example represented with ThemeA theme</span>
<span class="c1">// The module has widget</span>
<span class="c1">// The module has close button</span>
<span class="c1">// The module has resize control</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="jsa-example-1">JSA Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Builder Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false, require:false */</span>
    
<span class="kd">var</span> <span class="nx">jsa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../../../vendors/jsa/jsa.umd&quot;</span><span class="p">),</span>
    <span class="c1">// Widget is used to build a product</span>
    <span class="nx">AbstractWidgetClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
    <span class="nx">MockWidgetClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">AbstractWidgetClass</span><span class="p">,</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="s2">&quot;The module has widget&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Concrete product</span>
    <span class="nx">module</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
    <span class="c1">// Abstract builder</span>
    <span class="nx">AbstractBuilderClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">markup</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nx">getModule</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">markup</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="nx">DirectorInterface</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">construct</span><span class="o">:</span> <span class="p">[</span> <span class="nx">AbstractBuilderClass</span> <span class="p">]</span>
    <span class="p">},</span>
    <span class="c1">// Director</span>
    <span class="nx">moduleManagerClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__implements__</span><span class="o">:</span> <span class="nx">DirectorInterface</span><span class="p">,</span>
            <span class="nx">construct</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">builder</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">builder</span><span class="p">.</span><span class="nx">buildWindow</span><span class="p">(</span> <span class="nx">options</span><span class="p">.</span><span class="nx">title</span> <span class="p">);</span>
                <span class="nx">options</span><span class="p">.</span><span class="nx">widget</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachWidget</span><span class="p">(</span> <span class="nx">options</span><span class="p">.</span><span class="nx">widget</span> <span class="p">);</span>
                <span class="nx">options</span><span class="p">.</span><span class="nx">isClosable</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachCloseButton</span><span class="p">();</span>
                <span class="nx">options</span><span class="p">.</span><span class="nx">isResizable</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachResizeControl</span><span class="p">();</span>
                <span class="k">return</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">getModule</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="nx">BuilderInterface</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">buildWindow</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;string&quot;</span> <span class="p">],</span>
        <span class="nx">attachCloseButton</span><span class="o">:</span> <span class="p">[],</span>
        <span class="nx">attachWidget</span><span class="o">:</span> <span class="p">[</span> <span class="nx">AbstractWidgetClass</span> <span class="p">],</span>
        <span class="nx">attachResizeControl</span><span class="o">:</span> <span class="p">[]</span>
    <span class="p">},</span>
    <span class="c1">// Concrete builder</span>
    <span class="nx">ThemeAClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">AbstractBuilderClass</span><span class="p">,</span>
            <span class="nx">__implements__</span><span class="o">:</span> <span class="nx">BuilderInterface</span><span class="p">,</span>
            <span class="nx">buildWindow</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">title</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;Module &quot;</span> <span class="o">+</span> <span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot; represented with ThemeA theme\n&quot;</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">attachCloseButton</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;The module has close button\n&quot;</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">attachWidget</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">widget</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="nx">widget</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
            <span class="p">},</span>
            <span class="nx">attachResizeControl</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;The module has resize control\n&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
    <span class="nx">module</span> <span class="o">=</span> <span class="nx">moduleManagerClass</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">({</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Example&quot;</span><span class="p">,</span>
        <span class="nx">widget</span><span class="o">:</span> <span class="nx">MockWidgetClass</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(),</span>
        <span class="nx">isClosable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">isResizable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}).</span><span class="nx">construct</span><span class="p">(</span> <span class="nx">ThemeAClass</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">()</span> <span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">module</span> <span class="p">);</span>

<span class="c1">// Output</span>
<span class="c1">// Module Example represented with ThemeA theme</span>
<span class="c1">// The module has widget</span>
<span class="c1">// The module has close button</span>
<span class="c1">// The module has resize control</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="typescript-example-1">TypeScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Builder Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">console</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">WidgetOptions</span>
<span class="p">{</span>
    <span class="nx">title</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
    <span class="nx">widget</span><span class="o">:</span> <span class="nx">AbstractWidget</span><span class="p">;</span>
    <span class="nx">isClosable</span><span class="o">:</span> <span class="nx">bool</span><span class="p">;</span>
    <span class="nx">isResizable</span><span class="o">:</span> <span class="nx">bool</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Widget is used to build a product</span>
<span class="kr">interface</span> <span class="nx">AbstractWidget</span> 
<span class="p">{</span>
    <span class="nx">render</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">MockWidget</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;The module has widget&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">BuilderInterface</span>
<span class="p">{</span>
    <span class="nx">buildWindow</span><span class="o">:</span> <span class="p">(</span> <span class="nx">title</span><span class="o">:</span> <span class="nx">string</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
    <span class="nx">attachCloseButton</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
    <span class="nx">attachWidget</span><span class="o">:</span> <span class="p">(</span> <span class="nx">widget</span><span class="o">:</span> <span class="nx">AbstractWidget</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
    <span class="nx">attachResizeControl</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
    <span class="nx">getModule</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">AbstractBuilder</span> 
<span class="p">{</span>
    <span class="kr">public</span> <span class="nx">markup</span><span class="o">:</span> <span class="nx">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="kr">public</span> <span class="nx">getModule</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">markup</span><span class="p">;</span>          
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// Director</span>
<span class="kr">class</span> <span class="nx">moduleManager</span>
<span class="p">{</span>
    <span class="kr">private</span> <span class="nx">options</span><span class="o">:</span> <span class="nx">WidgetOptions</span><span class="p">;</span>

    <span class="nx">constructor</span><span class="p">(</span> <span class="nx">options</span><span class="o">:</span> <span class="nx">WidgetOptions</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="nx">construct</span><span class="p">(</span> <span class="nx">builder</span><span class="o">:</span> <span class="nx">BuilderInterface</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">builder</span><span class="p">.</span><span class="nx">buildWindow</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">title</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">widget</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachWidget</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">widget</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">isClosable</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachCloseButton</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">isResizable</span> <span class="o">&amp;&amp;</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">attachResizeControl</span><span class="p">();</span>
        <span class="k">return</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">getModule</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Concrete builder</span>
<span class="kr">class</span> <span class="nx">ThemeA</span> <span class="kr">extends</span> <span class="nx">AbstractBuilder</span> 
<span class="p">{</span>
  
    <span class="kr">public</span> <span class="nx">buildWindow</span><span class="p">(</span> <span class="nx">title</span><span class="o">:</span> <span class="nx">string</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;Module &quot;</span> <span class="o">+</span> <span class="nx">title</span> <span class="o">+</span> <span class="s2">&quot; represented with ThemeA theme\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">attachCloseButton</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;The module has close button\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">attachWidget</span><span class="p">(</span> <span class="nx">widget</span><span class="o">:</span> <span class="nx">AbstractWidget</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="nx">widget</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">attachResizeControl</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">markup</span> <span class="o">+=</span> <span class="s2">&quot;The module has resize control\n&quot;</span><span class="p">;</span>
    <span class="p">}</span>
        
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
    <span class="kd">var</span> <span class="nx">pageModule</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">moduleManager</span><span class="p">({</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Example&quot;</span><span class="p">,</span>
        <span class="nx">widget</span><span class="o">:</span> <span class="k">new</span> <span class="nx">MockWidget</span><span class="p">(),</span>
        <span class="nx">isClosable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">isResizable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
    <span class="nx">pageModule</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ThemeA</span><span class="p">()</span> <span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">pageModule</span> <span class="p">);</span>

<span class="c1">// Output</span>
<span class="c1">// Module Example represented with ThemeA theme</span>
<span class="c1">// The module has widget</span>
<span class="c1">// The module has close button</span>
<span class="c1">// The module has resize control</span>
</code></pre></div>

<h2 class="bs-docs-section" id="object-creational-prototype">Prototype</h2>

<blockquote cite="http://www.goodreads.com/book/show/85009.Design_Patterns">
<p>
Specify the kinds of objects to create using a prototypical instance, and create new objects by copying this prototype.
</p>
<footer>â€”  <cite><a title="Gamma, Erich; Helm, Richard; Johnson, Ralph; Vlissides, John (1994-10-31). Design Patterns: Elements of Reusable Object-Oriented Software" href="http://www.goodreads.com/book/show/85009.Design_Patterns">Gang of Four</a></cite></footer>
</blockquote>

<p><img src="./assets/img/Prototype/uml.png" alt="Prototype pattern class diagram" /></p>

<p>The pattern allows:</p>

<ul>
  <li>creating new objects identical or closely resembling existing ones;</li>
  <li>avoiding expense operation when it is required for the initial creating of an object;</li>
  <li>to decouple composition, creating and representation of objects.</li>
</ul>

<p>Usually when we need one object to extend another we bring into play inheritance.
So we declare a class or a base object in prototype-based languages per every
kind of derived objects, even if they scarcely differ. However using Prototype
we can reduce the number of classes.</p>

<h3 id="php-example-2">PHP Example</h3>

<p>Let&#8217;s assume, we deal with micro-formats in our application.
The application is built on the framework, which already has base class (<var>Element</var>)
for HTML element objects. Thus, every element makes an instance of this class.
Micro-format elements are HTML elements, which are marked in a particular way
by the class attribute. So, to get them, we could subclass <var>Element</var>.
However, that would produce a lot of subclasses, which differ only by
the micro-format type the derived objects represent. Besides, it would be inconsistent to the framework design.
How do we solve it? Instead of generalization we will use composition.
We create an HTML element object by instantiating <var>Element</var> class.
We pass to the constructor tag name to specify which exact element it is.
Now we have a state-full object, which we clone every time we need a new a micro-format element object.</p>

<p><img src="./assets/img/Prototype/PHP/uml.png" alt="Prototype pattern PHP example class diagram" /></p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Prototype Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="k">namespace</span> <span class="nx">Framework\Html</span><span class="p">;</span>

<span class="k">final</span> <span class="k">class</span> <span class="nc">Element</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$_tag</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$_class</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$_content</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$_childElements</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>


    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$tag</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_tag</span> <span class="o">=</span> <span class="nv">$tag</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setClass</span><span class="p">(</span><span class="nv">$class</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_class</span> <span class="o">=</span> <span class="nv">$class</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setContent</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_content</span> <span class="o">=</span> <span class="nv">$content</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">addChild</span><span class="p">(</span><span class="k">array</span> <span class="nv">$elements</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_childElements</span> <span class="o">=</span> <span class="nv">$elements</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">strtr</span><span class="p">(</span><span class="s1">&#39;&lt;%tag% class=&quot;%class%&quot;&gt;&#39;</span>
            <span class="o">.</span> <span class="s1">&#39;%content% %childElements%&lt;/%tag%&gt;&#39;</span>
            <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
            <span class="s2">&quot;%tag%&quot;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_tag</span><span class="p">,</span>
            <span class="s2">&quot;%content%&quot;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_content</span><span class="p">,</span>
            <span class="s2">&quot;%childElements%&quot;</span> <span class="o">=&gt;</span> <span class="nb">array_reduce</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_childElements</span>
                <span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$res</span><span class="p">,</span> <span class="nv">$el</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$el</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$res</span> <span class="o">.=</span> <span class="nx">PHP_EOL</span> <span class="o">.</span> <span class="nv">$el</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">());</span>
                <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
            <span class="p">},</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;%class%&quot;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_class</span><span class="p">,</span>
        <span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Usage</span>
<span class="sd"> */</span>
<span class="nv">$div</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Framework\Html\Element</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="nv">$span</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Framework\Html\Element</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">);</span>

<span class="nv">$fn</span> <span class="o">=</span> <span class="k">clone</span> <span class="nv">$span</span><span class="p">;</span>
<span class="nv">$fn</span><span class="o">-&gt;</span><span class="na">setClass</span><span class="p">(</span><span class="s2">&quot;fn&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setContent</span><span class="p">(</span><span class="s2">&quot;John Snow&quot;</span><span class="p">);</span>

<span class="nv">$org</span> <span class="o">=</span> <span class="k">clone</span> <span class="nv">$span</span><span class="p">;</span>
<span class="nv">$org</span><span class="o">-&gt;</span><span class="na">setClass</span><span class="p">(</span><span class="s2">&quot;org&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setContent</span><span class="p">(</span><span class="s2">&quot;Night Watch&quot;</span><span class="p">);</span>

<span class="nv">$vcard</span> <span class="o">=</span> <span class="k">clone</span> <span class="nv">$div</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$vcard</span><span class="o">-&gt;</span><span class="na">setClass</span><span class="p">(</span><span class="s2">&quot;vcard&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">addChild</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="nv">$org</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>

<span class="c1">// Output</span>

<span class="c1">// &lt;div class=&quot;vcard&quot;&gt;</span>
<span class="c1">// &lt;span class=&quot;fn&quot;&gt;John Snow &lt;/span&gt;</span>
<span class="c1">//</span>
<span class="c1">// &lt;span class=&quot;org&quot;&gt;Night Watch &lt;/span&gt;</span>
<span class="c1">// &lt;/div&gt;</span>
</code></pre></div>

<h3 id="javascript-example-2">JavaScript Example</h3>

<p>In this imaginable application we need a button to submit the form (Save changes)
 and a button to preserve the form data (Save draft). The framework comprises
 an object representing an abstract button (<var>Toolbar.Button</var>). The object&#8217;s
 constructor receives configuration object as an argument (object specifiers). Thus, any instance
 of <var>Toolbar.Button</var> makes a configured button. Any button meant for saving has
 a particular appearance. In <a href="http://twitter.github.com/bootstrap">Twitter Bootstrap 2</a> it is gained by adding class
 <var>btn-primary</var>. So, we clone default button object and add the class to it.
 Save changes button and Save draft button differ only by onClick event
 handlers. In everything else they are the same as default save button. So
 we can clone saveBtn object and, then, assign the handler to each.</p>

<p><img src="./assets/img/Prototype/EcmaScript/uml.png" alt="Prototype pattern EcmaScript example class diagram" /></p>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Prototype Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> * </span>
<span class="cm">   </span>
<span class="cm"> */</span>

<span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nb">window</span> <span class="p">){</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
<span class="cm">/*global console:false */</span>

<span class="kd">var</span> <span class="nb">document</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
    <span class="nx">console</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">,</span>
    <span class="nx">Toolbar</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">Button</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">&quot;btn-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">size</span> <span class="o">+</span> 
                <span class="s2">&quot; btn-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">display</span><span class="p">;</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">addClass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">className</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s2">&quot; btn-&quot;</span> <span class="o">+</span> <span class="nx">className</span><span class="p">;</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">};</span>
            
            <span class="k">this</span><span class="p">.</span><span class="nx">setOnClickHandler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">callback</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span> <span class="s1">&#39;keypress&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">};</span>
            
            <span class="k">this</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="p">);</span>
            <span class="p">};</span>
            
        <span class="p">}</span>
    <span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="kd">var</span> <span class="nx">abstractBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Toolbar</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span> <span class="nx">size</span><span class="o">:</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="nx">display</span><span class="o">:</span> <span class="s2">&quot;inline&quot;</span> <span class="p">}),</span>
    <span class="c1">// Clone abstract abstractBtn for saveBtn</span>
    <span class="nx">saveBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">abstractBtn</span> <span class="p">)</span>
        <span class="c1">// saveBtn has specific state</span>
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;primary&quot;</span><span class="p">),</span> 
    <span class="c1">// Clone saveBtn for saveChangesBtn    </span>
    <span class="nx">saveChangesBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">saveBtn</span> <span class="p">)</span>
        <span class="c1">// Specific handler for saveChangesBtn</span>
        <span class="p">.</span><span class="nx">setOnClickHandler</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">e</span> <span class="p">){</span> 
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Changes saved&quot;</span><span class="p">);</span>
    <span class="p">}),</span>
    <span class="c1">// Clone saveBtn for saveDraftBtn</span>
    <span class="nx">saveDraftBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">saveBtn</span> <span class="p">)</span>
        <span class="c1">// Specific handler for saveDraftBtn</span>
        <span class="p">.</span><span class="nx">setOnClickHandler</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">e</span> <span class="p">){</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Draft saved&quot;</span><span class="p">);</span>
    <span class="p">});</span>

<span class="nx">saveDraftBtn</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">saveChangesBtn</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>

<span class="c1">// Output:</span>
<span class="c1">// &lt;button class=&quot;btn-large btn-inline btn-primary&quot;&gt;</span>
<span class="c1">// &lt;button class=&quot;btn-large btn-inline btn-primary&quot;&gt;</span>

<span class="p">}(</span> <span class="nb">window</span> <span class="p">));</span>
</code></pre></div>

<h3 id="jsa-example-2">JSA Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Prototype Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>

<span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nb">window</span> <span class="p">){</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
 <span class="cm">/*global console:false, require:false, escape:false, unescape:false */</span>

<span class="kd">var</span> <span class="nb">document</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
    <span class="nx">console</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">,</span>
    <span class="nx">jsa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../../../vendors/jsa/jsa.umd&quot;</span><span class="p">),</span>
    <span class="nx">Toolbar</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">Button</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;button&quot;</span> <span class="p">);</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">&quot;btn-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">size</span> <span class="o">+</span> 
                <span class="s2">&quot; btn-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">display</span><span class="p">;</span>
            
            <span class="k">return</span> <span class="p">{</span>
               <span class="nx">addClass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">className</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s2">&quot; btn-&quot;</span> <span class="o">+</span> <span class="nx">className</span><span class="p">;</span>
                    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                <span class="p">},</span>
            
                <span class="nx">setOnClickHandler</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">callback</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="nx">node</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span> <span class="s1">&#39;keypress&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>
                    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                <span class="p">},</span>

                <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">node</span> <span class="p">);</span>
                <span class="p">}</span>
                
            <span class="p">}</span>
            
        <span class="p">}</span>
    <span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="kd">var</span> <span class="nx">abstractBtn</span> <span class="o">=</span> <span class="nx">Toolbar</span><span class="p">.</span><span class="nx">Button</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">({</span> 
    <span class="nx">size</span><span class="o">:</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> 
    <span class="nx">display</span><span class="o">:</span> <span class="s2">&quot;inline&quot;</span> 
<span class="p">}),</span>
    
    <span class="c1">// Clone abstract abstractBtn for saveBtn</span>
    <span class="nx">saveBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">abstractBtn</span> <span class="p">)</span>
        <span class="c1">// saveBtn has specific state</span>
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="s2">&quot;primary&quot;</span> <span class="p">),</span> 
    <span class="c1">// Clone saveBtn for saveChangesBtn    </span>
    <span class="nx">saveChangesBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">saveBtn</span> <span class="p">)</span>
        <span class="c1">// Specific handler for saveChangesBtn</span>
        <span class="p">.</span><span class="nx">setOnClickHandler</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">e</span> <span class="p">){</span> 
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Changes saved&quot;</span> <span class="p">);</span>
    <span class="p">}),</span>
    <span class="c1">// Clone saveBtn for saveDraftBtn</span>
    <span class="nx">saveDraftBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">saveBtn</span> <span class="p">)</span>
        <span class="c1">// Specific handler for saveDraftBtn</span>
        <span class="p">.</span><span class="nx">setOnClickHandler</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">e</span> <span class="p">){</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Draft saved&quot;</span> <span class="p">);</span>
    <span class="p">});</span>

<span class="nx">saveDraftBtn</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">saveChangesBtn</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>

<span class="c1">// Output:</span>
<span class="c1">// &lt;button class=&quot;btn-large btn-inline btn-primary&quot;&gt;</span>
<span class="c1">// &lt;button class=&quot;btn-large btn-inline btn-primary&quot;&gt;</span>

<span class="p">}(</span> <span class="nb">window</span> <span class="p">));</span>
</code></pre></div>

<h3 id="typescript-example-2">TypeScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Prototype Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nb">window</span><span class="p">;</span>
<span class="nx">declare</span> <span class="kd">var</span> <span class="nb">document</span><span class="p">;</span>
<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">console</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">ButtonOptions</span>
<span class="p">{</span>
    <span class="nx">size</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span> 
    <span class="nx">display</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">module</span> <span class="nx">Toolbar</span>
<span class="p">{</span>
    <span class="kr">export</span> <span class="kr">interface</span> <span class="nx">ButtonInterface</span>
    <span class="p">{</span>
        <span class="nx">node</span><span class="o">:</span> <span class="nx">HTMLElement</span><span class="p">;</span>
        <span class="nx">addClass</span><span class="p">(</span> <span class="nx">className</span><span class="o">:</span> <span class="nx">string</span> <span class="p">)</span><span class="o">:</span> <span class="nx">ButtonInterface</span><span class="p">;</span>
        <span class="nx">setOnClickHandler</span><span class="p">(</span> <span class="nx">callback</span><span class="o">:</span> <span class="p">(</span> <span class="nx">e</span><span class="o">:</span> <span class="nx">Event</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Toolbar</span><span class="p">.</span><span class="nx">Button</span> <span class="p">)</span><span class="o">:</span> 
            <span class="nx">ButtonInterface</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kr">export</span> <span class="kr">class</span> <span class="nx">Button</span>
    <span class="p">{</span>
        <span class="kr">private</span> <span class="nx">node</span><span class="o">:</span> <span class="nx">HTMLElement</span><span class="p">;</span>

        <span class="nx">constructor</span><span class="p">(</span> <span class="nx">options</span><span class="o">:</span> <span class="nx">ButtonOptions</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;button&quot;</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">&quot;btn-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">size</span> <span class="o">+</span> 
                <span class="s2">&quot; btn-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">display</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">public</span> <span class="nx">addClass</span><span class="p">(</span> <span class="nx">className</span><span class="o">:</span> <span class="nx">string</span> <span class="p">)</span><span class="o">:</span> <span class="nx">ButtonInterface</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s2">&quot; btn-&quot;</span> <span class="o">+</span> <span class="nx">className</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kr">public</span> <span class="nx">setOnClickHandler</span><span class="p">(</span> 
            <span class="nx">callback</span><span class="o">:</span> <span class="p">(</span> <span class="nx">e</span><span class="o">:</span> <span class="nx">Event</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Toolbar</span><span class="p">.</span><span class="nx">Button</span> <span class="p">)</span><span class="o">:</span> <span class="nx">ButtonInterface</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span> <span class="s1">&#39;keypress&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">public</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>



<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="kd">var</span> <span class="nx">abstractBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Toolbar</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span> 
    <span class="nx">size</span><span class="o">:</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> 
    <span class="nx">display</span><span class="o">:</span> <span class="s2">&quot;inline&quot;</span> 
<span class="p">}),</span>
    
    <span class="c1">// Clone abstract abstractBtn for saveBtn</span>
    <span class="nx">saveBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">abstractBtn</span> <span class="p">)</span>
        <span class="c1">// saveBtn has specific state</span>
        <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="s2">&quot;primary&quot;</span> <span class="p">),</span> 
    <span class="c1">// Clone saveBtn for saveChangesBtn    </span>
    <span class="nx">saveChangesBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">saveBtn</span> <span class="p">)</span>
        <span class="c1">// Specific handler for saveChangesBtn</span>
        <span class="p">.</span><span class="nx">setOnClickHandler</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">e</span><span class="o">:</span> <span class="nx">Event</span> <span class="p">){</span> 
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Changes saved&quot;</span> <span class="p">);</span>
    <span class="p">}),</span>
    <span class="c1">// Clone saveBtn for saveDraftBtn</span>
    <span class="nx">saveDraftBtn</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="nx">saveBtn</span> <span class="p">)</span>
        <span class="c1">// Specific handler for saveDraftBtn</span>
        <span class="p">.</span><span class="nx">setOnClickHandler</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">e</span><span class="o">:</span> <span class="nx">Event</span> <span class="p">){</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Draft saved&quot;</span> <span class="p">);</span>
    <span class="p">});</span>

<span class="nx">saveDraftBtn</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">saveChangesBtn</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>

<span class="c1">// Output:</span>
<span class="c1">// &lt;button class=&quot;btn-large btn-inline btn-primary&quot;&gt;</span>
<span class="c1">// &lt;button class=&quot;btn-large btn-inline btn-primary&quot;&gt;</span>
</code></pre></div>

<h2 class="bs-docs-section" id="object-creational-singleton">Singleton</h2>

<blockquote cite="http://www.goodreads.com/book/show/85009.Design_Patterns">
<p>
Ensure a class only has one instance, and provide a global point of access to it.
</p>
<footer>â€”  <cite><a title="Gamma, Erich; Helm, Richard; Johnson, Ralph; Vlissides, John (1994-10-31). Design Patterns: Elements of Reusable Object-Oriented Software" href="http://www.goodreads.com/book/show/85009.Design_Patterns">Gang of Four</a></cite></footer>
</blockquote>

<p><img src="./assets/img/Singleton/uml.png" alt="Singleton pattern class diagram" /></p>

<p>The pattern allows:</p>

<ul>
  <li>control over concrete class instantiating so that the only instance could be obtained.</li>
</ul>

<p>Singleton is used to restrict instantiation of a class to one object.
This is useful when exactly one object is needed to coordinate actions across the system.</p>

<h3 id="php-example-3">PHP Example</h3>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Singleton Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="k">class</span> <span class="nc">Singleton</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nv">$_instance</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">public</span> <span class="nv">$foo</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getInstance</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$_instance</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_instance</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$_instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">self</span><span class="p">());</span>
    <span class="p">}</span>

<span class="p">}</span>
<span class="sd">/**</span>
<span class="sd"> * Usage</span>
<span class="sd"> */</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nx">\Singleton</span><span class="o">::</span><span class="na">getInstance</span><span class="p">()</span> <span class="o">===</span> <span class="nx">\Singleton</span><span class="o">::</span><span class="na">getInstance</span><span class="p">());</span>

<span class="sd">/**</span>
<span class="sd"> * Output</span>
<span class="sd"> */</span>
<span class="c1">// true</span>
</code></pre></div>

<h3 id="javascript-example-3">JavaScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Singleton Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
<span class="cm">/*global console:false */</span>

<span class="kd">var</span> <span class="nx">o1</span><span class="p">,</span>
    <span class="nx">o2</span><span class="p">,</span>
    <span class="nx">Singleton</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nx">Singleton</span><span class="p">.</span><span class="nx">_selfInstance</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Singleton</span><span class="p">.</span><span class="nx">_selfInstance</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">Singleton</span><span class="p">.</span><span class="nx">_selfInstance</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">;</span>
  <span class="p">};</span>
<span class="cm">/*</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
<span class="nx">o1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Singleton</span><span class="p">();</span>
<span class="nx">o2</span> <span class="o">=</span> <span class="nx">Singleton</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">o1</span> <span class="o">===</span> <span class="nx">o2</span> <span class="p">);</span>
<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// true</span>
<span class="p">}());</span>
</code></pre></div>

<h3 id="jsa-example-3">JSA Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Singleton Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">global</span> <span class="p">)</span> <span class="p">{</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
 <span class="cm">/*global console:false, require:false */</span>

<span class="kd">var</span> <span class="nx">jsa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../../../vendors/jsa/jsa.umd&quot;</span><span class="p">),</span>
    <span class="nx">o1</span><span class="p">,</span>
    <span class="nx">o2</span><span class="p">,</span>
    <span class="nx">Singleton</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nx">Singleton</span><span class="p">.</span><span class="nx">_selfInstance</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Singleton</span><span class="p">.</span><span class="nx">_selfInstance</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span> <span class="nx">Singleton</span><span class="p">.</span><span class="nx">_selfInstance</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">foo</span><span class="o">:</span> <span class="s2">&quot;initialValue&quot;</span>
        <span class="p">});</span>
  <span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
<span class="nx">Singleton</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">();</span>
<span class="nx">o1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Singleton</span><span class="p">();</span>
<span class="nx">o2</span> <span class="o">=</span> <span class="nx">Singleton</span><span class="p">();</span>
<span class="nx">o2</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="s2">&quot;changedValue&quot;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">o1</span><span class="p">.</span><span class="nx">foo</span> <span class="o">===</span> <span class="nx">o2</span><span class="p">.</span><span class="nx">foo</span> <span class="p">);</span>
<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// true</span>

<span class="p">}(</span> <span class="k">this</span><span class="p">));</span>
</code></pre></div>

<h3 id="typescript-example-3">TypeScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Singleton Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>


<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">console</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">Singleton</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">;</span>
    <span class="kr">static</span> <span class="nx">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kr">static</span> <span class="nx">getInstance</span><span class="p">()</span><span class="o">:</span> <span class="nx">Singleton</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">instance</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Singleton</span><span class="p">()</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Singleton</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">()</span> <span class="o">===</span> <span class="nx">Singleton</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">());</span>

<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// true</span>
</code></pre></div>

<h2 class="bs-docs-section" id="object-structural-bridge">Bridge</h2>

<blockquote cite="http://www.goodreads.com/book/show/85009.Design_Patterns">
<p>
Decouple an abstraction from its implementation so that the two can vary independently.
</p>
<footer>â€”  <cite><a title="Gamma, Erich; Helm, Richard; Johnson, Ralph; Vlissides, John (1994-10-31). Design Patterns: Elements of Reusable Object-Oriented Software" href="http://www.goodreads.com/book/show/85009.Design_Patterns">Gang of Four</a></cite></footer>
</blockquote>

<p><img src="./assets/img/Bridge/uml.png" alt="Bridge pattern class diagram" /></p>

<p>The pattern allows:</p>

<ul>
  <li>to avoid permanent binding between abstraction and its implementation;</li>
  <li>deferring the presence of the implementation to the point where the abstraction is utilized</li>
</ul>

<p>Alike Abstract Factory and Bridge decouples an abstraction from its implementation.
Actually Abstract Factory can be used to build a particular Bridge.
But what is unique about Bridge - it provides an architecture where abstraction
and implementation are in separate class hierarchies.</p>

<h3 id="php-example-4">PHP Example</h3>

<p>PHP example shows the case where web statistics data can be retrieved from different sources
(Google Analytics and local DB) and be presented in table or graphic form.
Using inheritance we define <var>ImpAbstract</var> and subclasses <var>GoogleAnalytics</var> and <var>LocalAnalytics</var>
which implement <var>ImpAbstract</var> interface for both data sources.
<var>AnalyticsAbstract</var> consumes API provided by <var>ImpAbstract</var> and expose own
methods to subsclasses <var>GraphViewData</var> and <var>TableViewData</var>.</p>

<p><img src="./assets/img/Bridge/PHP/uml.png" alt="Bridge pattern PHP example class diagram" /></p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Bridge Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>


<span class="c1">// File: ./Analytics/TableViewData.php</span>
<span class="k">namespace</span> <span class="nx">Analytics</span><span class="p">;</span>
<span class="c1">// Refined Abstraction</span>
<span class="k">class</span> <span class="nc">TableViewData</span> <span class="k">extends</span> <span class="nx">AnalyticsAbstract</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="c1">// File: ./Analytics/GraphViewData.php</span>
<span class="k">namespace</span> <span class="nx">Analytics</span><span class="p">;</span>
<span class="c1">// Refined Abstraction</span>
<span class="k">class</span> <span class="nc">GraphViewData</span> <span class="k">extends</span> <span class="nx">AnalyticsAbstract</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">queryAudienceStats</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_imp</span><span class="o">-&gt;</span><span class="na">queryVisitsRate</span><span class="p">(</span><span class="nv">$profileId</span><span class="p">,</span> <span class="nv">$sDate</span><span class="p">,</span> <span class="nv">$eDate</span><span class="p">),</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_imp</span><span class="o">-&gt;</span><span class="na">queryPageViewsRate</span><span class="p">(</span><span class="nv">$profileId</span><span class="p">,</span> <span class="nv">$sDate</span><span class="p">,</span> <span class="nv">$eDate</span><span class="p">)</span>
        <span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Analytics/Imp/GoogleAnalytics.php</span>

<span class="k">namespace</span> <span class="nx">Analytics\Imp</span><span class="p">;</span>
<span class="c1">// Concrete implementror</span>
<span class="k">class</span> <span class="nc">GoogleAnalytics</span> <span class="k">extends</span> <span class="nx">ImpAbstract</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">queryVisitsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Mock query</span>
        <span class="k">return</span> <span class="s2">&quot;Visits rate stats array&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">queryPageViewsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Mock query</span>
        <span class="k">return</span> <span class="s2">&quot;Page views rate stats array&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Analytics/Imp/LocalAnalytics.php</span>
<span class="k">namespace</span> <span class="nx">Analytics\Imp</span><span class="p">;</span>

<span class="c1">// Concrete implementror</span>
<span class="k">class</span> <span class="nc">LocalAnalytics</span> <span class="k">extends</span> <span class="nx">ImpAbstract</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">queryVisitsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Mock query</span>
        <span class="k">return</span> <span class="s2">&quot;Visits rate stats array&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">queryPageViewsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Mock query</span>
        <span class="k">return</span> <span class="s2">&quot;Page views rate stats array&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Analytics/Imp/ImpAbstract.php</span>

<span class="k">namespace</span> <span class="nx">Analytics\Imp</span><span class="p">;</span>
<span class="c1">// Implementer on the Bridge</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">ImpAbstract</span>
<span class="p">{</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">queryVisitsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">);</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">queryPageViewsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// File: ./Analytics/AnalyticsAbstract.php</span>

<span class="k">namespace</span> <span class="nx">Analytics</span><span class="p">;</span>
<span class="c1">// Abstraction on the Bridge</span>
<span class="c1">// Abstraction forwards client requests to its Implementor object.</span>
<span class="k">class</span> <span class="nc">AnalyticsAbstract</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$_imp</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_imp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Analytics\Imp\GoogleAnalytics</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">queryVisitsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_imp</span><span class="o">-&gt;</span><span class="na">queryVisitsRate</span><span class="p">(</span><span class="nv">$profileId</span><span class="p">,</span> <span class="nv">$sDate</span><span class="p">,</span> <span class="nv">$eDate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">queryPageViewsRate</span><span class="p">(</span><span class="nv">$profileId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$sDate</span> <span class="o">=</span> <span class="s1">&#39;-1 week&#39;</span><span class="p">,</span> <span class="nv">$eDate</span> <span class="o">=</span> <span class="s1">&#39;-1 day&#39;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_imp</span><span class="o">-&gt;</span><span class="na">queryPageViewsRate</span><span class="p">(</span><span class="nv">$profileId</span><span class="p">,</span> <span class="nv">$sDate</span><span class="p">,</span> <span class="nv">$eDate</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//File: example.php</span>

<span class="k">include</span> <span class="s1">&#39;Analytics/Imp/ImpAbstract.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Analytics/Imp/GoogleAnalytics.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Analytics/Imp/LocalAnalytics.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Analytics/AnalyticsAbstract.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Analytics/GraphViewData.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Analytics/TableViewData.php&#39;</span><span class="p">;</span>


<span class="sd">/**</span>
<span class="sd"> * Usage</span>
<span class="sd"> */</span>
<span class="nv">$tblDataSrc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Analytics\TableViewData</span><span class="p">();</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$tblDataSrc</span><span class="o">-&gt;</span><span class="na">queryVisitsRate</span><span class="p">());</span>

<span class="nv">$graphDataSrc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Analytics\GraphViewData</span><span class="p">();</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$graphDataSrc</span><span class="o">-&gt;</span><span class="na">queryAudienceStats</span><span class="p">());</span>
<span class="cm">/*</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// Visits rate stats array</span>
<span class="c1">// [&quot;Visits rate stats array&quot;,&quot;Page views rate stats array&quot;]</span>
</code></pre></div>

<h3 id="javascript-example-4">JavaScript Example</h3>

<p>EcmaScript examples describe a solution for themable widget (slideshow).
Consider a slideshow which is meant to have thumbnail- or bullets-like
pagination depending on a theme and act differently on desktop and mobile devices.
Here the slideshow doesn&#8217;t have pagination on mobiles devices, but supports
touch gestures to navigate slides.</p>

<p><var>AbstractImplementor</var> implies an interface to be implemented by by all its derivatives:
theme classes and subclasses. <var>AbstractSlideShow</var> is a client to <var>AbstractImplementor</var>,
which forward the API to subclasses <var>OnDesktopSlideShow</var> and <var>OnMobileSlideShow</var>.</p>

<p><img src="./assets/img/Bridge/EcmaScript/uml.png" alt="Bridge pattern EcmaScript example class diagram" /></p>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Bridge Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span> <span class="nx">global</span> <span class="p">)</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false */</span>
    <span class="c1">// Implementer on the Bridge</span>
<span class="kd">var</span> <span class="nx">AbstractImplementor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">renderBorder</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Border&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Concrete implementer</span>
    <span class="nx">themeA</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractImplementor</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">renderPaginator</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Thumbnails&quot;</span><span class="p">);</span>
        <span class="p">}}</span>
    <span class="p">}),</span>
    <span class="c1">// Concrete implementer</span>
    <span class="nx">themeB</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractImplementor</span><span class="p">(),</span> <span class="p">{</span>
        <span class="nx">renderPaginator</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Bullets&quot;</span><span class="p">);</span>
        <span class="p">}}</span>
    <span class="p">}),</span>
    <span class="c1">// Abstraction on the Bridge</span>
    <span class="c1">// Abstraction forwards client requests to its Implementor object.</span>
    <span class="nx">AbstractSlideShow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">renderBorder</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">imp</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
            <span class="p">},</span>
            <span class="nx">renderNavigation</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">imp</span><span class="p">.</span><span class="nx">renderPaginator</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Refined Abstraction</span>
    <span class="nx">onDesktopSlideShow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractSlideShow</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">),</span> <span class="p">{</span>
            <span class="nx">bindNavigation</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Navigation bound&quot;</span><span class="p">);</span>
            <span class="p">}},</span>
            <span class="nx">render</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">renderNavigation</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">bindNavigation</span><span class="p">();</span>
            <span class="p">}}</span>
        <span class="p">});</span>
    <span class="p">},</span>
    <span class="c1">// Refined Abstraction</span>
    <span class="nx">onMobileSlideShow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span> <span class="k">new</span> <span class="nx">AbstractSlideShow</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">),</span> <span class="p">{</span>
            <span class="nx">bindTouchGestures</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Touch gestures bound&quot;</span><span class="p">);</span>
            <span class="p">}},</span>
            <span class="nx">render</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">bindTouchGestures</span><span class="p">();</span>
            <span class="p">}}</span>
        <span class="p">});</span>
    <span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="nx">onDesktopSlideShow</span><span class="p">(</span> <span class="nx">themeA</span> <span class="p">).</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">onDesktopSlideShow</span><span class="p">(</span> <span class="nx">themeB</span> <span class="p">).</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">onMobileSlideShow</span><span class="p">(</span> <span class="nx">themeA</span> <span class="p">).</span><span class="nx">render</span><span class="p">();</span>
<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>

<span class="c1">// Border</span>
<span class="c1">// Thumbnails</span>
<span class="c1">// Navigation bound</span>
<span class="c1">//</span>
<span class="c1">// Border</span>
<span class="c1">// Bullets</span>
<span class="c1">// Navigation bound</span>
<span class="c1">//</span>
<span class="c1">// Border</span>
<span class="c1">// Touch gestures bound</span>

<span class="p">}(</span> <span class="k">this</span> <span class="p">));</span>
</code></pre></div>

<h3 id="jsa-example-4">JSA Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Bridge Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span> <span class="nx">global</span> <span class="p">)</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false, require:false */</span>

<span class="kd">var</span> <span class="nx">jsa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../../../vendors/jsa/jsa.umd&quot;</span><span class="p">),</span>
        <span class="c1">// Implementer on the Bridge</span>
    <span class="nx">AbstractImplementor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">renderBorder</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Border&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Concrete implementer</span>
    <span class="nx">ThemeA</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;__extends__&quot;</span><span class="o">:</span> <span class="nx">AbstractImplementor</span><span class="p">,</span>
            <span class="nx">renderPaginator</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Thumbnails&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Concrete implementer</span>
    <span class="nx">ThemeB</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;__extends__&quot;</span><span class="o">:</span> <span class="nx">AbstractImplementor</span><span class="p">,</span>
            <span class="nx">renderPaginator</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Bullets&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Abstraction on the Bridge</span>
    <span class="c1">// Abstraction forwards client requests to its Implementor object.</span>
    <span class="nx">AbstractSlideShow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;__constructor__&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">imp</span> <span class="o">=</span> <span class="nx">imp</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">imp</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nx">renderBorder</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">imp</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
            <span class="p">},</span>
            <span class="nx">renderNavigation</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">imp</span><span class="p">.</span><span class="nx">renderPaginator</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Refined Abstraction</span>
    <span class="nx">OnDesktopSlideShow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;__extends__&quot;</span><span class="o">:</span> <span class="nx">AbstractSlideShow</span><span class="p">,</span>
            <span class="nx">bindNavigation</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Navigation bound&quot;</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

                <span class="k">this</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">renderNavigation</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">bindNavigation</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Refined Abstraction</span>
    <span class="nx">OnMobileSlideShow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;__extends__&quot;</span><span class="o">:</span> <span class="nx">AbstractSlideShow</span><span class="p">,</span>
            <span class="nx">bindTouchGestures</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Touch gestures bound&quot;</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">bindTouchGestures</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">deskThemAImp</span> <span class="o">=</span> <span class="nx">OnDesktopSlideShow</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span> <span class="nx">ThemeA</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">()</span> <span class="p">),</span>
    <span class="nx">deskThemBImp</span> <span class="o">=</span> <span class="nx">OnDesktopSlideShow</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span> <span class="nx">ThemeB</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">()</span> <span class="p">),</span>
    <span class="nx">mobileThemAImp</span> <span class="o">=</span> <span class="nx">OnMobileSlideShow</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span> <span class="nx">ThemeA</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">()</span> <span class="p">);</span>

<span class="nx">deskThemAImp</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">deskThemBImp</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">mobileThemAImp</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>

<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// Border</span>
<span class="c1">// Thumbnails</span>
<span class="c1">// Navigation bound</span>
<span class="c1">//</span>
<span class="c1">// Border</span>
<span class="c1">// Bullets</span>
<span class="c1">// Navigation bound</span>
<span class="c1">//</span>
<span class="c1">// Border</span>
<span class="c1">// Touch gestures bound</span>

<span class="p">}(</span> <span class="k">this</span> <span class="p">));</span>
</code></pre></div>

<h3 id="typescript-example-4">TypeScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Bridge Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">console</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">ImplementorInterface</span>
<span class="p">{</span>
    <span class="nx">renderBorder</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
    <span class="nx">renderPaginator</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Implementer on the Bridge</span>
<span class="kr">class</span> <span class="nx">AbstractImplementor</span> <span class="kr">implements</span> <span class="nx">ImplementorInterface</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="nx">renderBorder</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
    <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Border&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Workaround abstract method. This one is required</span>
    <span class="c1">// due to implemented interface but yet empty; is meant to be overriden</span>
    <span class="kr">public</span> <span class="nx">renderPaginator</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Concrete implementer</span>
<span class="kr">class</span> <span class="nx">ThemeA</span> <span class="kr">extends</span> <span class="nx">AbstractImplementor</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="nx">renderPaginator</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Thumbnails&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Concrete implementer</span>
<span class="kr">class</span> <span class="nx">ThemeB</span> <span class="kr">extends</span> <span class="nx">AbstractImplementor</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="nx">renderPaginator</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Bullets&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Abstraction on the Bridge</span>
<span class="c1">// Abstraction forwards client requests to its Implementor object.</span>
<span class="kr">class</span> <span class="nx">AbstractSlideShow</span>
<span class="p">{</span>
    <span class="kr">private</span> <span class="nx">imp</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">imp</span><span class="o">:</span> <span class="nx">AbstractImplementor</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">imp</span> <span class="o">=</span> <span class="nx">imp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="nx">renderBorder</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">imp</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="nx">renderNavigation</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">imp</span><span class="p">.</span><span class="nx">renderPaginator</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Refined Abstraction</span>
<span class="kr">class</span> <span class="nx">OnDesktopSlideShow</span> <span class="kr">extends</span> <span class="nx">AbstractSlideShow</span>
<span class="p">{</span>
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">imp</span><span class="o">:</span> <span class="nx">AbstractImplementor</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="nx">bindNavigation</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
    <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Navigation bound&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">renderNavigation</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">bindNavigation</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Refined Abstraction</span>
<span class="kr">class</span> <span class="nx">OnMobileSlideShow</span> <span class="kr">extends</span> <span class="nx">AbstractSlideShow</span>
<span class="p">{</span>
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">imp</span><span class="o">:</span> <span class="nx">AbstractImplementor</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span> <span class="nx">imp</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="nx">bindTouchGestures</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
    <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Touch gestures bound&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">render</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">renderBorder</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">bindTouchGestures</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="kd">var</span> <span class="nx">deskThemAImp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OnDesktopSlideShow</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ThemeA</span><span class="p">()</span> <span class="p">),</span>
    <span class="nx">deskThemBImp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OnDesktopSlideShow</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ThemeB</span><span class="p">()</span> <span class="p">),</span>
    <span class="nx">mobileThemAImp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OnMobileSlideShow</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ThemeA</span><span class="p">()</span> <span class="p">);</span>

<span class="nx">deskThemAImp</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">deskThemBImp</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nx">mobileThemAImp</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>


<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// Border</span>
<span class="c1">// Thumbnails</span>
<span class="c1">// Navigation bound</span>
<span class="c1">//</span>
<span class="c1">// Border</span>
<span class="c1">// Bullets</span>
<span class="c1">// Navigation bound</span>
<span class="c1">//</span>
<span class="c1">// Border</span>
<span class="c1">// Touch gestures bound</span>
</code></pre></div>

<h2 class="bs-docs-section" id="object-structural-decorator">Decorator</h2>

<blockquote cite="http://www.goodreads.com/book/show/85009.Design_Patterns">
<p>
Attach additional responsibilities to an object dynamically. Decorators provide a flexible alternative to subclassing for extending functionality.
</p>
<footer>â€”  <cite><a title="Gamma, Erich; Helm, Richard; Johnson, Ralph; Vlissides, John (1994-10-31). Design Patterns: Elements of Reusable Object-Oriented Software" href="http://www.goodreads.com/book/show/85009.Design_Patterns">Gang of Four</a></cite></footer>
</blockquote>

<p><img src="./assets/img/Decorator/uml.png" alt="Decorator pattern class diagram" /></p>

<p>The pattern allows:</p>

<ul>
  <li>for extending (decoration) the functionality of a certain object at run-time, independently of other instances of the same class.</li>
</ul>

<p>When we need to enhance an individual object with a particular responsibility, use of inheritance may be impractical.
Let&#8217;s say we have a widget class. In some cases we need this widget with border,
in some with scrollbar, in some with both. Relying on inheritance we would need
not only classes for every representation, but also classes for every combination, provided
number of possible combinations increases excessively with every new added representation. Using decorators
we can configure representation on the fly. So we make an instance of the concrete widget and pass it to the scrollbar decorator.
Then we pass derived object to the border decorator. Thus, we get the widget enhanced with both border and scrollbar.</p>

<p>Known uses
ZF 1.x utilizes the decorator pattern in order to render elements and forms.
So when you need a custom representation for a form element, you
can use one or more decorators on the element class to achieve exactly what you want.</p>

<h3 id="php-example-5">PHP Example</h3>

<p>In following example we have \Widget\Concrete class implementing \Widget\WidgetInterface and two
decorators (\Widget\Decorator\Scrollbar and \Widget\Decorator\StatusBar) that implement
interface of \Widget\Decorator\AbstractDecorator. When we need the widget with
scrollbar and status bar we just wrap widget instance with corresponding decorators.</p>

<p><img src="./assets/img/Decorator/PHP/uml.png" alt="Decorator pattern PHP example class diagram" /></p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Decorator Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>


<span class="c1">// File: ./Widget/Concrete.php</span>
<span class="k">namespace</span> <span class="nx">Widget</span><span class="p">;</span>

<span class="c1">// Default implementation of a Widget</span>
<span class="k">final</span> <span class="k">class</span> <span class="nc">Concrete</span> <span class="k">implements</span> <span class="nx">WidgetInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span> 
    <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;Concrete widget&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Decorator/AbstractDecorator.php</span>
<span class="k">namespace</span> <span class="nx">Widget\Decorator</span><span class="p">;</span>

<span class="c1">// Abstract decorator class that implements WidgetInterface</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">AbstractDecorator</span> <span class="k">implements</span> <span class="nx">\Widget\WidgetInterface</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$_widget</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">\Widget\WidgetInterface</span> <span class="nv">$widget</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_widget</span> <span class="o">=</span> <span class="nv">$widget</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span>
    <span class="p">{</span>        
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_widget</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Decorator/ScrollBar.php</span>
<span class="k">namespace</span> <span class="nx">Widget\Decorator</span><span class="p">;</span>

<span class="c1">// Concrete decorator which adds scrollbar functionality</span>
<span class="k">class</span> <span class="nc">ScrollBar</span> <span class="k">extends</span> <span class="nx">AbstractDecorator</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">\Widget\WidgetInterface</span> <span class="nv">$widget</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$widget</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span> 
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">render</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; with scrollbar&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/Decorator/StatusBar.php</span>
<span class="k">namespace</span> <span class="nx">Widget\Decorator</span><span class="p">;</span>

<span class="c1">// Concrete decorator which adds statusbar functionality</span>
<span class="k">class</span> <span class="nc">StatusBar</span> <span class="k">extends</span> <span class="nx">AbstractDecorator</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">\Widget\WidgetInterface</span> <span class="nv">$widget</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$widget</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span> 
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">render</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; with statusbar&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Widget/WidgetInterface.php</span>
<span class="k">namespace</span> <span class="nx">Widget</span><span class="p">;</span>
<span class="c1">// Widget interface</span>
<span class="k">interface</span> <span class="nx">WidgetInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">();</span>
<span class="p">}</span>
<span class="c1">//File: example.php</span>

<span class="cm">/*</span>
<span class="cm"> * Usage </span>
<span class="cm"> */</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/WidgetInterface.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Concrete.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Decorator/AbstractDecorator.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Decorator/ScrollBar.php&quot;</span><span class="p">;</span>
<span class="k">include</span> <span class="s2">&quot;./Widget/Decorator/StatusBar.php&quot;</span><span class="p">;</span>

<span class="nv">$widget</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Widget\Decorator\StatusBar</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">\Widget\Decorator\ScrollBar</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">\Widget\Concrete</span><span class="p">()</span>
    <span class="p">)</span>
<span class="p">);</span>
<span class="k">print</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">()</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// Concrete widget with scrollbar with statusbar</span>
</code></pre></div>

<h3 id="javascript-example-5">JavaScript Example</h3>

<p>This example shows Decorator pattern from an other prospective. We have here an object, which represents
a concrete product MacbookAir. It&#8217;s one of the class defined by MacbookAbstract.
The object comprises the base product configuration and corresponding price.
Now we can specify decorators for extensible configuration properties (<var>RAM</var>, <var>SDD</var>).
Combination of decorators will give a product object of the intended configuration.
It can be used e.g. for price calculator.</p>

<p><img src="./assets/img/Decorator/EcmaScript/uml.png" alt="Decorator pattern EcmaScript example class diagram" /></p>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Decorator Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false */</span>
    
    <span class="c1">// Object to be decorated</span>
<span class="kd">var</span> <span class="nx">MacbookAir</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="c1">// Decorator MacbookRamExtended, that represents </span>
    <span class="c1">// Macbook configuration with extended RAM</span>
    <span class="nx">ExtendedRam</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">macbookAir</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">price</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">ram</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">macbookAir</span><span class="p">;</span>
    <span class="p">},</span> 
    <span class="c1">// Decorator MacbookSddExtended, that represents </span>
    <span class="c1">// Macbook configuration with extended SDD</span>
    <span class="nx">ExtendedSdd</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">macbookAir</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">price</span> <span class="o">+=</span> <span class="mi">200</span><span class="p">;</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">sdd</span> <span class="o">+=</span> <span class="mi">128</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">macbookAir</span><span class="p">;</span>
    <span class="p">};</span>
    
<span class="nx">MacbookAir</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">ram</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="nx">sdd</span><span class="o">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="nx">price</span><span class="o">:</span> <span class="mi">1199</span><span class="p">,</span>

    <span class="nx">getPrice</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;$&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">price</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">getSpec</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;13-inch MacBook Air\nRAM: &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">ram</span> <span class="o">+</span> <span class="s2">&quot;\nSDD: &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">sdd</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span> 
 <span class="c1">// Let&#39;s get maximum extended configuration</span>
 <span class="kd">var</span> <span class="nx">myMacbook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ExtendedSdd</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ExtendedRam</span><span class="p">(</span><span class="k">new</span> <span class="nx">MacbookAir</span><span class="p">())</span> <span class="p">);</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">myMacbook</span><span class="p">.</span><span class="nx">getSpec</span><span class="p">()</span> <span class="p">);</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Price: &quot;</span> <span class="o">+</span> <span class="nx">myMacbook</span><span class="p">.</span><span class="nx">getPrice</span><span class="p">()</span> <span class="p">);</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Is myMacbook instance of MacbookAir: &quot;</span><span class="p">,</span> <span class="nx">myMacbook</span> <span class="k">instanceof</span> <span class="nx">MacbookAir</span> <span class="p">);</span>
<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// 13-inch MacBook Air</span>
<span class="c1">// RAM: 8</span>
<span class="c1">// SDD: 256</span>
<span class="c1">// Price: $1499</span>
<span class="c1">// Is myMacbook instance of MacbookAir:  true</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="jsa-example-5">JSA Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Bridge Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false, require:false */</span>
    
<span class="kd">var</span> <span class="nx">jsa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../../../vendors/jsa/jsa.umd&quot;</span><span class="p">),</span>
    <span class="nx">MacbookAbstract</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">getPrice</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="s2">&quot;$&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">price</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">getSpec</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="s2">&quot;13-inch MacBook Air\nRAM: &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">ram</span> <span class="o">+</span> <span class="s2">&quot;\nSDD: &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">sdd</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Object to be decorated</span>
    <span class="nx">MacbookAir</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">MacbookAbstract</span><span class="p">,</span>
            <span class="nx">ram</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="nx">sdd</span><span class="o">:</span> <span class="mi">128</span><span class="p">,</span>
            <span class="nx">price</span><span class="o">:</span> <span class="mi">1199</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="c1">// Decorator MacbookRamExtended, that represents </span>
    <span class="c1">// Macbook configuration with extended RAM    </span>
    <span class="nx">ExtendedRam</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">macbookAir</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">price</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">ram</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">macbookAir</span><span class="p">;</span>
    <span class="p">},</span> 
    <span class="c1">// Decorator MacbookSddExtended, that represents </span>
    <span class="c1">// Macbook configuration with extended SDD</span>
    <span class="nx">ExtendedSdd</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">macbookAir</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">price</span> <span class="o">+=</span> <span class="mi">200</span><span class="p">;</span>
        <span class="nx">macbookAir</span><span class="p">.</span><span class="nx">sdd</span> <span class="o">+=</span> <span class="mi">128</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">macbookAir</span><span class="p">;</span>
    <span class="p">};</span>
        
 
<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span> 
 <span class="c1">// Let&#39;s get maximum extended configuration</span>
 <span class="kd">var</span> <span class="nx">myMacbook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ExtendedSdd</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">ExtendedRam</span><span class="p">(</span><span class="nx">MacbookAir</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">())</span>
 <span class="p">);</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">myMacbook</span><span class="p">.</span><span class="nx">getSpec</span><span class="p">()</span> <span class="p">);</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Price: &quot;</span> <span class="o">+</span> <span class="nx">myMacbook</span><span class="p">.</span><span class="nx">getPrice</span><span class="p">()</span> <span class="p">);</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Is myMacbook instance of MacbookAir: &quot;</span><span class="p">,</span> <span class="nx">myMacbook</span> <span class="k">instanceof</span> <span class="nx">MacbookAir</span> <span class="p">);</span>
<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// 13-inch MacBook Air</span>
<span class="c1">// RAM: 8</span>
<span class="c1">// SDD: 256</span>
<span class="c1">// Price: $1499</span>
<span class="c1">// Is myMacbook instance of MacbookAir:  true</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="typescript-example-5">TypeScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Bridge Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">console</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">Macbook</span>
<span class="p">{</span>
    <span class="nx">getPrice</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span> <span class="c1">// returns Macbook price in dollars</span>
    <span class="nx">getRam</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span> <span class="c1">// returns size of RAM (GB)</span>
    <span class="nx">getSdd</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span> <span class="c1">// returns size of SDD (GB)</span>
<span class="p">}</span>
<span class="c1">// MacbookAir default configuration</span>
<span class="kr">class</span> <span class="nx">MacbookAir</span> 
<span class="p">{</span>
    <span class="kr">private</span> <span class="nx">ram</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="kr">private</span> <span class="nx">sdd</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
    <span class="kr">private</span> <span class="nx">price</span> <span class="o">=</span> <span class="mi">1199</span><span class="p">;</span>

    <span class="kr">public</span> <span class="nx">getPrice</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">price</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">getSdd</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">sdd</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">getRam</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">ram</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Abstract decorator class.  It implements Coffee Macbook</span>
<span class="kr">class</span> <span class="nx">AbstractMacbookDecorator</span> 
<span class="p">{</span>
    <span class="kr">public</span> <span class="nx">macbook</span><span class="p">;</span>

    <span class="nx">constructor</span><span class="p">(</span><span class="nx">macbook</span><span class="o">:</span> <span class="nx">Macbook</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span> <span class="o">=</span> <span class="nx">macbook</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// implementing methods of the interface</span>
    <span class="kr">public</span> <span class="nx">getPrice</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span><span class="p">.</span><span class="nx">getPrice</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">getRam</span><span class="p">()</span>
    <span class="p">{</span>   
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span><span class="p">.</span><span class="nx">getRam</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">getSdd</span><span class="p">()</span>
    <span class="p">{</span>   
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span><span class="p">.</span><span class="nx">getSdd</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Decorator MacbookRamExtended, that represents </span>
<span class="c1">// Macbook configuration with extended RAM</span>
<span class="kr">class</span> <span class="nx">MacbookRamExtendedDecorator</span> <span class="kr">extends</span> <span class="nx">AbstractMacbookDecorator</span>
<span class="p">{</span>
    
    <span class="nx">constructor</span><span class="p">(</span> <span class="nx">macbook</span><span class="o">:</span> <span class="nx">Macbook</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span> <span class="nx">macbook</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// overriding methods defined in the abstract superclass</span>
    <span class="kr">public</span> <span class="nx">getPrice</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span><span class="p">.</span><span class="nx">getPrice</span><span class="p">()</span> <span class="o">+</span> <span class="mi">100</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">getRam</span><span class="p">()</span>
    <span class="p">{</span>   
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span><span class="p">.</span><span class="nx">getRam</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Decorator MacbookSddExtended, that represents </span>
<span class="c1">// Macbook configuration with extended SDD</span>
<span class="kr">class</span> <span class="nx">MacbookSddExtendedDecorator</span> <span class="kr">extends</span> <span class="nx">AbstractMacbookDecorator</span>
<span class="p">{</span>
    
    <span class="nx">constructor</span><span class="p">(</span> <span class="nx">macbook</span><span class="o">:</span> <span class="nx">Macbook</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span> <span class="nx">macbook</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">getPrice</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span><span class="p">.</span><span class="nx">getPrice</span><span class="p">()</span> <span class="o">+</span> <span class="mi">200</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kr">public</span> <span class="nx">getSdd</span><span class="p">()</span>
    <span class="p">{</span>   
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">macbook</span><span class="p">.</span><span class="nx">getSdd</span><span class="p">()</span> <span class="o">+</span> <span class="mi">128</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>
<span class="c1">// Let&#39;s get maximum extended configuration</span>
<span class="kd">var</span> <span class="nx">myMacbook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MacbookSddExtendedDecorator</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">MacbookRamExtendedDecorator</span><span class="p">(</span><span class="k">new</span> <span class="nx">MacbookAir</span><span class="p">())</span>
<span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;13-inch MacBook Air\nRAM: &quot;</span> <span class="o">+</span> <span class="nx">myMacbook</span><span class="p">.</span><span class="nx">getRam</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;\nSDD: &quot;</span> <span class="o">+</span> <span class="nx">myMacbook</span><span class="p">.</span><span class="nx">getSdd</span><span class="p">()</span> <span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Price: $&quot;</span> <span class="o">+</span> <span class="nx">myMacbook</span><span class="p">.</span><span class="nx">getPrice</span><span class="p">()</span> <span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>

<span class="c1">// 13-inch MacBook Air</span>
<span class="c1">// RAM: 8</span>
<span class="c1">// SDD: 256</span>
<span class="c1">// Price: $1499</span>
</code></pre></div>

<h2 class="bs-docs-section" id="object-structural-flyweight">Flyweight</h2>

<blockquote cite="http://www.goodreads.com/book/show/85009.Design_Patterns">
<p>
Use sharing to support large numbers of fine-grained objects efficiently.
</p>
<footer>â€”  <cite><a title="Gamma, Erich; Helm, Richard; Johnson, Ralph; Vlissides, John (1994-10-31). Design Patterns: Elements of Reusable Object-Oriented Software" href="http://www.goodreads.com/book/show/85009.Design_Patterns">Gang of Four</a></cite></footer>
</blockquote>

<p><img src="./assets/img/Flyweight/uml.png" alt="Flyweight pattern class diagram" /></p>

<p>The pattern allows:</p>

<ul>
  <li>to reuse of many objects so, to make the utilization of large numbers of objects more efficient.</li>
</ul>

<p>Flyweight is an object which can be shared. The trick is to split object state into: intrinsic and extrinsic ones.
Flyweight stores its intrinsic state, but extrinsic one is kept by the flyweight context. Thus, being reused
the same object instance can have different aggregate states depending on the given flyweight context.</p>

<h3 id="php-example-6">PHP Example</h3>

<p>If we were to build a text editor, it would take unacceptably much of memory to allocate all the objects graphically representing characters in the document.
Except we use flyweights. Character flyweight stores only character code. All the related attributes are kept by flyweight context.
So, we declare Glyph interface to be implemented by any glyph (character, row, maybe column etc.).
Row represents a sequence of characters. Logically it is a Composite. <var>GlyphContext</var> is an iterator, which maps glyph sequence
extracts to some extrinsic state. For an instance, all the glyphs of a sequence from index A till index B are associated with
Times Roman 12 font. <var>GlyphContext</var> must be kept informed of the current position in the glyph structure during traversal.
E.g. when Row performs insert, <var>GlyphContext::next</var> is called.
<var>GlyphContext</var> sequence index increments with every Row::insert call.
For <var>Row::render</var>, <var>GlyphContext</var> index is set on the beginning of the sequence and with every <var>Character::render</var> request it iterates.
Thus, Character has <var>GlyphContext</var> with index set up according to the Character location in the sequence.
During Character rendering <var>GlyphContext::getFont</var> returns the font object we expect.</p>

<p>As you see <var>GlyphContext</var> acts as extrinsic state repository.
Besides, it&#8217;s glyph representation context. You can have many <var>GlyphContext</var> instances keeping different
rendering attributes for the same glyph structure. So by switching context you choose representation strategy for the structure.</p>

<p>Flyweights are created by means a factory, which ensures they are shared properly.
<var>GlyphFactory</var> caches statically <var>Character</var> instances while they are being created. If instance corresponding to the requested one
 already exists in the cache, it is used instead of creation of a new instance.</p>

<p><img src="./assets/img/Flyweight/PHP/uml.png" alt="Flyweight pattern PHP example class diagram" /></p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Flyweight Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>


<span class="c1">// File: ./Font/AbstractFont.php</span>

<span class="k">namespace</span> <span class="nx">Font</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Sample fonts</span>
<span class="cm"> */</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">AbstractFont</span>
<span class="p">{</span>

<span class="p">}</span>

<span class="c1">// File: ./Font/Times.php</span>

<span class="k">namespace</span> <span class="nx">Font</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Times</span> <span class="k">extends</span> <span class="nx">AbstractFont</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$attr</span> <span class="o">=</span> <span class="s2">&quot;Times Roman 12 &quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// File: ./Font/VerdanaBold.php</span>

<span class="k">namespace</span> <span class="nx">Font</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">VerdanaBold</span> <span class="k">extends</span> <span class="nx">AbstractFont</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$attr</span> <span class="o">=</span> <span class="s2">&quot;Verdana Bold 12&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// File: ./Glyph/AbstractGlyph.php</span>

<span class="k">namespace</span> <span class="nx">Glyph</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Flyweight interface</span>
<span class="cm"> */</span>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">AbstractGlyph</span>
<span class="p">{</span>
    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">(</span><span class="nx">\Window\Context</span> <span class="nv">$window</span><span class="p">,</span> 
        <span class="nx">\Glyph\Context</span> <span class="o">&amp;</span><span class="nv">$glyphContext</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// File: ./Glyph/Character.php</span>

<span class="k">namespace</span> <span class="nx">Glyph</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Concerte flyweight, keeps intrinsic state</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">Character</span> <span class="k">extends</span> <span class="nx">AbstractGlyph</span>
<span class="p">{</span>
    <span class="c1">// Intirinsic state, independent of GlyphContext</span>
    <span class="k">private</span> <span class="nv">$_char</span><span class="p">;</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$char</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_char</span> <span class="o">=</span> <span class="nv">$char</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// Render character on the window</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">(</span><span class="nx">\Window\Context</span> <span class="nv">$window</span><span class="p">,</span> <span class="nx">\Glyph\Context</span> <span class="o">&amp;</span><span class="nv">$glyphContext</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$window</span><span class="o">-&gt;</span><span class="na">push</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_char</span><span class="p">,</span> <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">getFont</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">attr</span><span class="p">,</span> <span class="nb">spl_object_hash</span><span class="p">(</span><span class="nv">$this</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Glyph/Context.php</span>

<span class="k">namespace</span> <span class="nx">Glyph</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Repository of extrinsic state. </span>
<span class="cm"> * Here it keeps flyweight (character) attributes such as font info</span>
<span class="cm"> * By applying various contextes we can make the same glyph </span>
<span class="cm"> * structure look differently</span>
<span class="cm"> */</span>

<span class="k">class</span> <span class="nc">Context</span> 
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$_fonts</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">private</span> <span class="nv">$_indices</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">private</span> <span class="nv">$_curFont</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">private</span> <span class="nv">$_defaultFont</span><span class="p">;</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span> 
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_defaultFont</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Font\Times</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="c1">// To the begining of the sequence</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">rewind</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_indices</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Iterate sequence index</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">next</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_indices</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Mark the point where font switches on the sequence</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setFont</span><span class="p">(</span><span class="nx">\Font\AbstractFont</span> <span class="nv">$font</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_fonts</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_indices</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">]]</span> <span class="o">=</span> <span class="nv">$font</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getFont</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_fonts</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_indices</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">]]))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_curFont</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_fonts</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_indices</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">]];</span>
        <span class="p">}</span> 
        <span class="k">return</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_curFont</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">])</span> <span class="o">?</span> 
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_curFont</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span><span class="p">]</span> <span class="o">:</span> 
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_defaultFont</span><span class="p">;</span>
        
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setSeqContext</span><span class="p">(</span><span class="nx">\Glyph\AbstractGlyph</span> <span class="nv">$visitor</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">seqId</span> <span class="o">=</span> <span class="nb">spl_object_hash</span><span class="p">(</span><span class="nv">$visitor</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// File: ./Glyph/Factory.php</span>

<span class="k">namespace</span> <span class="nx">Glyph</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Creates flyweights and ensures they are shared properly</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">Factory</span>
<span class="p">{</span>
    <span class="c1">// The _chars array contains pointers to Character glyphs indexed </span>
    <span class="c1">// by character.</span>
    <span class="k">private</span> <span class="k">static</span> <span class="nv">$_chars</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">createChar</span><span class="p">(</span><span class="nv">$char</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="nv">$_chars</span><span class="p">[</span><span class="nv">$char</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nx">self</span><span class="o">::</span><span class="nv">$_chars</span><span class="p">[</span><span class="nv">$char</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Glyph\Character</span><span class="p">(</span><span class="nv">$char</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_chars</span><span class="p">[</span><span class="nv">$char</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">createRow</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">\Glyph\Row</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Glyph/Row.php</span>

<span class="k">namespace</span> <span class="nx">Glyph</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Unshared concerte flyweight</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">Row</span> <span class="k">extends</span> <span class="nx">AbstractGlyph</span>
<span class="p">{</span>
    <span class="c1">// Has concrete flyweight objects as children</span>
    <span class="k">protected</span> <span class="nv">$_glyphs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    
    <span class="c1">// Render row of characters on the window</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">(</span><span class="nx">\Window\Context</span> <span class="nv">$window</span><span class="p">,</span> <span class="nx">\Glyph\Context</span> <span class="o">&amp;</span><span class="nv">$glyphContext</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">setSeqContext</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span>
        <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">rewind</span><span class="p">();</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_glyphs</span> <span class="k">as</span> <span class="nv">$glyph</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$glyph</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="nv">$window</span><span class="p">,</span> <span class="nv">$glyphContext</span><span class="p">);</span>
            <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
   
    <span class="c1">// Insert a character into the row</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">insert</span><span class="p">(</span><span class="nx">\Glyph\AbstractGlyph</span> <span class="nv">$glyph</span><span class="p">,</span> <span class="nx">\Glyph\Context</span> <span class="o">&amp;</span><span class="nv">$glyphContext</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_glyphs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$glyph</span><span class="p">;</span>
        <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">setSeqContext</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span>
        <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">();</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// Switch font on the context</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setFont</span><span class="p">(</span><span class="nx">\Font\AbstractFont</span> <span class="nv">$font</span><span class="p">,</span> <span class="nx">\Glyph\Context</span> <span class="o">&amp;</span><span class="nv">$glyphContext</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">setSeqContext</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span>
        <span class="nv">$glyphContext</span><span class="o">-&gt;</span><span class="na">setFont</span><span class="p">(</span><span class="nv">$font</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// File: ./Window/Context.php</span>

<span class="k">namespace</span> <span class="nx">Window</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Output context</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">Context</span> 
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$_chars</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">private</span> <span class="nv">$_attrs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">private</span> <span class="nv">$_hashes</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="nf">push</span><span class="p">(</span><span class="nv">$char</span><span class="p">,</span> <span class="nv">$attr</span><span class="p">,</span> <span class="nv">$objHash</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_chars</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$char</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_attrs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$attr</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_hashes</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$objHash</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">render</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$matches</span> <span class="o">=</span> <span class="nb">array_count_values</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_hashes</span><span class="p">);</span>
        <span class="k">print</span> <span class="s2">&quot;Row content:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_chars</span> <span class="k">as</span> <span class="nv">$inx</span> <span class="o">=&gt;</span> <span class="nv">$char</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">printf</span><span class="p">(</span><span class="s2">&quot;%s - %s%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$char</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_attrs</span><span class="p">[</span><span class="nv">$inx</span><span class="p">],</span> 
                <span class="nv">$matches</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_hashes</span><span class="p">[</span><span class="nv">$inx</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="s2">&quot;  reused&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span> 
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//File: example.php</span>

<span class="k">include</span> <span class="s1">&#39;Glyph/AbstractGlyph.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Glyph/Character.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Glyph/Context.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Glyph/Factory.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Glyph/Row.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Font/Abstractfont.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Font/Times.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Font/VerdanaBold.php&#39;</span><span class="p">;</span>
<span class="k">include</span> <span class="s1">&#39;Window/Context.php&#39;</span><span class="p">;</span>



<span class="c1">// Shortcut function</span>
<span class="k">function</span> <span class="nf">char</span><span class="p">(</span><span class="nv">$char</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nx">\Glyph\Factory</span><span class="o">::</span><span class="na">createChar</span><span class="p">(</span><span class="nv">$char</span><span class="p">);</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Usage</span>
<span class="sd"> */</span>

<span class="nv">$window</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Window\Context</span><span class="p">();</span>
<span class="nv">$times</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Font\Times</span><span class="p">();</span>
<span class="nv">$verdana</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Font\VerdanaBold</span><span class="p">();</span>
<span class="nv">$row</span> <span class="o">=</span> <span class="nx">\Glyph\Factory</span><span class="o">::</span><span class="na">createRow</span><span class="p">();</span>
<span class="nv">$context</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Glyph\Context</span><span class="p">();</span>
<span class="nv">$row</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">),</span> <span class="nv">$context</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="nv">$context</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">),</span> <span class="nv">$context</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">setFont</span><span class="p">(</span><span class="nv">$verdana</span><span class="p">,</span> <span class="nv">$context</span><span class="p">)</span> 
       <span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">),</span> <span class="nv">$context</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">),</span> <span class="nv">$context</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">setFont</span><span class="p">(</span><span class="nv">$times</span><span class="p">,</span> <span class="nv">$context</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nx">char</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">),</span> <span class="nv">$context</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="nv">$window</span><span class="p">,</span> <span class="nv">$context</span><span class="p">);</span>

<span class="nv">$window</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>

<span class="cm">/*</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">//Row content:</span>
<span class="c1">//e - Times Roman  12  reused</span>
<span class="c1">//x - Times Roman  12</span>
<span class="c1">//c - Times Roman  12</span>
<span class="c1">//e - Verdana Bold 12  reused</span>
<span class="c1">//e - Verdana Bold 12  reused</span>
<span class="c1">//d - Times Roman  12</span>
</code></pre></div>

<h3 id="javascript-example-6">JavaScript Example</h3>

<p>Error log entries can be numerous, though the number of error messages they store is limited.
We can define error message code as intrinsic state of <var>ErrorLogEntry</var> flyweight and datetime stamp as extrinsic state.
Whatever many errors are passed to <var>ErrorLogger</var>, it operates limited set of <var>ErrorLogEntry</var> instances, but
stores datetime stamps in <var>ErrorLogEntryContext</var>. So, the same instances of <var>ErrorLogEntry</var>, but in different contexts provide
the required information.</p>

<p><img src="./assets/img/Flyweight/EcmaScript/uml.png" alt="Flyweight pattern EcmaScript example class diagram" /></p>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Flyweight Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false */</span>

<span class="kd">var</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nx">ErrorMap</span> <span class="o">=</span> <span class="p">[],</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Flyweight </span>
<span class="cm">     */</span>
    <span class="nx">ErrorLogEntry</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">){</span>
       <span class="k">return</span> <span class="p">{</span>
           <span class="nx">getMessage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nx">ErrorMap</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
           <span class="p">}</span>
       <span class="p">};</span>
    <span class="p">},</span>
    <span class="cm">/**</span>
<span class="cm">     * Flyweight context keeps extrinsic state of ErrorLogEntry (datetime stamp)</span>
<span class="cm">     */</span>
    <span class="nx">ErrorLogEntryContext</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">date</span> <span class="p">){</span>
       <span class="k">return</span> <span class="p">{</span>
           <span class="nx">getDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nx">date</span><span class="p">;</span>
           <span class="p">}</span>
       <span class="p">};</span>
    <span class="p">},</span>

   <span class="cm">/**</span>
<span class="cm">    * FlyweightFactory creates flyweights and ensures they are shared properly</span>
<span class="cm">    */</span>
    <span class="nx">ErrorLogEntryFactory</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
       <span class="kd">var</span> <span class="nx">messages</span> <span class="o">=</span> <span class="p">[],</span> 
           <span class="nx">callCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
           <span class="nx">creationCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="k">return</span> <span class="p">{</span>
           <span class="nx">make</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                   <span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ErrorLogEntry</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">);</span>
                   <span class="nx">creationCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
               <span class="p">}</span>
               <span class="nx">callCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
               <span class="k">return</span> <span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">];</span>
           <span class="p">},</span>
           <span class="nx">getInstanceCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

               <span class="k">return</span> <span class="nx">creationCount</span><span class="p">;</span>
           <span class="p">},</span>
           <span class="nx">getRequestCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nx">callCount</span><span class="p">;</span>
           <span class="p">}</span>
       <span class="p">};</span>
    <span class="p">}()),</span>
    <span class="cm">/**</span>
<span class="cm">     * Client</span>
<span class="cm">     */</span>
    <span class="nx">ErrorLogger</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">errCodes</span> <span class="o">=</span> <span class="p">[],</span> 
            <span class="nx">dates</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">log</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">errCodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">.</span><span class="nx">make</span><span class="p">(</span><span class="nx">errCode</span><span class="p">)</span> <span class="p">);</span>
                <span class="nx">dates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ErrorLogEntryContext</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">())</span> <span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">printMessages</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">errCodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">logEntry</span><span class="p">,</span> <span class="nx">inx</span> <span class="p">){</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">logEntry</span><span class="p">.</span><span class="nx">getMessage</span><span class="p">(</span><span class="nx">dates</span><span class="p">[</span> <span class="nx">inx</span> <span class="p">])</span> <span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="nx">logger</span><span class="p">;</span>
    
<span class="nx">ErrorMap</span><span class="p">[</span><span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Insufficient argument type&#39;</span><span class="p">;</span>
<span class="nx">ErrorMap</span><span class="p">[</span><span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Insufficient argument value&#39;</span><span class="p">;</span>
<span class="nx">ErrorMap</span><span class="p">[</span><span class="nx">ERROR_NODE_IS_UNDEFINED</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Node is undefined&#39;</span><span class="p">;</span>



<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="nx">logger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ErrorLogger</span><span class="p">();</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="p">);</span>

<span class="nx">logger</span><span class="p">.</span><span class="nx">printMessages</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">.</span><span class="nx">getRequestCount</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; ErrorLogEntry instances were requested&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">.</span><span class="nx">getInstanceCount</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; LogEntry instances were really created&quot;</span><span class="p">);</span>


<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// Insufficient argument type Wed Jan 23 2013 21:41:07 GMT+0100 (CET)</span>
<span class="c1">// Insufficient argument type Wed Jan 23 2013 21:41:07 GMT+0100 (CET)</span>
<span class="c1">// Insufficient argument value Wed Jan 23 2013 21:41:07 GMT+0100 (CET)</span>
<span class="c1">// Insufficient argument type Wed Jan 23 2013 21:41:07 GMT+0100 (CET)</span>
<span class="c1">// Node is undefined Wed Jan 23 2013 21:41:07 GMT+0100 (CET)</span>
<span class="c1">// 5 ErrorLogEntry instances were requested</span>
<span class="c1">// 3 LogEntry instances were really created</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="jsa-example-6">JSA Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package Flyweight Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> * @jscs standard:Jquery</span>
<span class="cm"> * Code style: http://docs.jquery.com/JQuery_Core_Style_Guidelines</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="cm">/*global console:false, require:false, escape:false, unescape:false */</span>

<span class="kd">var</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nx">jsa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../../../vendors/jsa/jsa.umd&quot;</span><span class="p">),</span>
    <span class="nx">ErrorMap</span> <span class="o">=</span> <span class="p">[],</span>

    <span class="nx">FlyweightContext</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{};</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Flyweight context keeps extrinsic state of ErrorLogEntry (datetime stamp)</span>
<span class="cm">     */</span>
    <span class="nx">ErrorLogEntryContext</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
       <span class="kd">var</span> <span class="nx">date</span><span class="p">;</span>
       <span class="k">return</span> <span class="p">{</span>
           <span class="nx">__extends__</span><span class="o">:</span> <span class="nx">FlyweightContext</span><span class="p">,</span>
           <span class="nx">__constructor__</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">inputDate</span> <span class="p">)</span> <span class="p">{</span>
               <span class="nx">date</span> <span class="o">=</span> <span class="nx">inputDate</span><span class="p">;</span>
           <span class="p">},</span>
           <span class="nx">getDate</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nx">date</span><span class="p">;</span>
           <span class="p">}</span>
       <span class="p">};</span>
    <span class="p">},</span>

    <span class="nx">FlyweightInterface</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">getMessage</span><span class="o">:</span> <span class="nx">ErrorLogEntryContext</span>
    <span class="p">},</span>
    <span class="cm">/**</span>
<span class="cm">     * Flyweight</span>
<span class="cm">     */</span>
    <span class="nx">ErrorLogEntry</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
       <span class="k">return</span> <span class="p">{</span>
           <span class="nx">__implements__</span><span class="o">:</span> <span class="nx">FlyweightInterface</span><span class="p">,</span>
           <span class="nx">__constructor__</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span> <span class="p">{</span>
               <span class="k">this</span><span class="p">.</span><span class="nx">errCode</span> <span class="o">=</span> <span class="nx">errCode</span><span class="p">;</span>
           <span class="p">},</span>
           <span class="nx">errCode</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
           <span class="nx">getMessage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nx">ErrorMap</span><span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">errCode</span> <span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
           <span class="p">}</span>
       <span class="p">};</span>
    <span class="p">},</span>


   <span class="cm">/**</span>
<span class="cm">    * FlyweightFactory creates flyweights and ensures they are shared properly</span>
<span class="cm">    */</span>
    <span class="nx">ErrorLogEntryFactory</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
       <span class="kd">var</span> <span class="nx">messages</span> <span class="o">=</span> <span class="p">{},</span>
           <span class="nx">callCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
           <span class="nx">creationCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="k">return</span> <span class="p">{</span>
           <span class="nx">make</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span> <span class="p">{</span>
               <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                   <span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">ErrorLogEntry</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">);</span>
                   <span class="nx">creationCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
               <span class="p">}</span>
               <span class="nx">callCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
               <span class="k">return</span> <span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">];</span>
           <span class="p">},</span>
           <span class="nx">getInstanceCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

               <span class="k">return</span> <span class="nx">creationCount</span><span class="p">;</span>
           <span class="p">},</span>
           <span class="nx">getRequestCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nx">callCount</span><span class="p">;</span>
           <span class="p">}</span>
       <span class="p">};</span>
    <span class="p">}()),</span>

    <span class="nx">Client</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">log</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;number&quot;</span> <span class="p">],</span>
        <span class="nx">printMessages</span><span class="o">:</span> <span class="p">[]</span>
    <span class="p">},</span>
    <span class="cm">/**</span>
<span class="cm">     * Client</span>
<span class="cm">     */</span>
    <span class="nx">ErrorLogger</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">errCodes</span> <span class="o">=</span> <span class="p">[],</span>
            <span class="nx">dates</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">__implements__</span><span class="o">:</span> <span class="nx">Client</span><span class="p">,</span>
            <span class="nx">log</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">errCodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">.</span><span class="nx">make</span><span class="p">(</span><span class="nx">errCode</span><span class="p">)</span> <span class="p">);</span>
                <span class="nx">dates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">ErrorLogEntryContext</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">())</span> <span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">printMessages</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">errCodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">logEntry</span><span class="p">,</span> <span class="nx">inx</span> <span class="p">){</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">logEntry</span><span class="p">.</span><span class="nx">getMessage</span><span class="p">(</span><span class="nx">dates</span><span class="p">[</span> <span class="nx">inx</span> <span class="p">])</span> <span class="p">);</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">},</span>
    <span class="nx">logger</span><span class="p">;</span>

<span class="nx">ErrorMap</span><span class="p">[</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Insufficient argument type&#39;</span><span class="p">;</span>
<span class="nx">ErrorMap</span><span class="p">[</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Insufficient argument value&#39;</span><span class="p">;</span>
<span class="nx">ErrorMap</span><span class="p">[</span> <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Node is undefined&#39;</span><span class="p">;</span>


<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="nx">logger</span> <span class="o">=</span> <span class="nx">ErrorLogger</span><span class="p">.</span><span class="nx">createInstance</span><span class="p">();</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="p">);</span>

<span class="nx">logger</span><span class="p">.</span><span class="nx">printMessages</span><span class="p">();</span>



<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">.</span><span class="nx">getRequestCount</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; ErrorLogEntry instances were requested&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">.</span><span class="nx">getInstanceCount</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; LogEntry instances were really created&quot;</span><span class="p">);</span>


<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>
<span class="c1">// Insufficient argument type Wed Jan 23 2013 23:01:59 GMT+0100 (CET)</span>
<span class="c1">// Insufficient argument type Wed Jan 23 2013 23:01:59 GMT+0100 (CET)</span>
<span class="c1">// Insufficient argument value Wed Jan 23 2013 23:01:59 GMT+0100 (CET)</span>
<span class="c1">// Insufficient argument type Wed Jan 23 2013 23:01:59 GMT+0100 (CET)</span>
<span class="c1">// Node is undefined Wed Jan 23 2013 23:01:59 GMT+0100 (CET)</span>
<span class="c1">// 5 ErrorLogEntry instances were requested</span>
<span class="c1">// 3 LogEntry instances were really created</span>

<span class="p">}());</span>
</code></pre></div>

<h3 id="typescript-example-6">TypeScript Example</h3>

<div class="highlight"><pre><code class="js"><span class="cm">/*</span>
<span class="cm"> * @category Design Pattern Tutorial</span>
<span class="cm"> * @package flyweight Sample</span>
<span class="cm"> * @author Dmitry Sheiko &lt;me@dsheiko.com&gt;</span>
<span class="cm"> * @licence MIT</span>
<span class="cm"> */</span>

<span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">console</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nx">errorMap</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="nx">logger</span><span class="o">:</span> <span class="nx">Client</span><span class="p">;</span>

    <span class="c1">// Abstract flyweight context</span>
    <span class="kr">interface</span> <span class="nx">FlyweightContext</span>
    <span class="p">{</span>
        <span class="nx">getDate</span><span class="p">()</span><span class="o">:</span> <span class="nb">Date</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Flyweight context keeps extrinsic state of</span>
    <span class="c1">// ErrorLogEntry (datetime stamp)</span>
    <span class="kr">class</span> <span class="nx">ErrorLogEntryContext</span> <span class="kr">implements</span> <span class="nx">FlyweightContext</span>
    <span class="p">{</span>
        <span class="kr">private</span> <span class="nx">date</span><span class="p">;</span>
        <span class="nx">constructor</span><span class="p">(</span> <span class="nx">date</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">date</span> <span class="o">=</span> <span class="nx">date</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kr">public</span> <span class="nx">getDate</span><span class="p">()</span><span class="o">:</span> <span class="nb">Date</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">date</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Flyweight interface</span>
    <span class="kr">interface</span> <span class="nx">FlyweightInterface</span>
    <span class="p">{</span>
        <span class="nx">getMessage</span><span class="p">(</span> <span class="nx">context</span><span class="o">:</span> <span class="nx">FlyweightContext</span> <span class="p">)</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Concrete Flyweight</span>
    <span class="kr">class</span> <span class="nx">ErrorLogEntry</span> <span class="kr">implements</span> <span class="nx">FlyweightInterface</span>
    <span class="p">{</span>
        <span class="kr">private</span> <span class="nx">errCode</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
        <span class="nx">constructor</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errCode</span> <span class="o">=</span> <span class="nx">errCode</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kr">public</span> <span class="nx">getMessage</span><span class="p">(</span> <span class="nx">context</span><span class="o">:</span> <span class="nx">FlyweightContext</span> <span class="p">)</span><span class="o">:</span> <span class="nx">string</span>
        <span class="p">{</span>
               <span class="k">return</span> <span class="nx">errorMap</span><span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">errCode</span> <span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">context</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// FlyweightFactory creates flyweights and ensures they are shared properly</span>
    <span class="kr">class</span> <span class="nx">ErrorLogEntryFactory</span>
    <span class="p">{</span>
        <span class="kr">private</span> <span class="nx">messages</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="kr">private</span> <span class="nx">callCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kr">private</span> <span class="nx">creationCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="kr">public</span> <span class="nx">make</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span><span class="o">:</span> <span class="nx">string</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ErrorLogEntry</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">creationCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">callCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">[</span> <span class="nx">errCode</span> <span class="p">];</span>
        <span class="p">}</span>
        <span class="kr">public</span> <span class="nx">getInstanceCount</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">creationCount</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kr">public</span> <span class="nx">getRequestCount</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">callCount</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Client</span>
    <span class="kr">interface</span> <span class="nx">Client</span>
    <span class="p">{</span>
        <span class="nx">log</span><span class="p">(</span><span class="nx">errCode</span><span class="o">:</span> <span class="nx">number</span><span class="p">)</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
        <span class="nx">printMessages</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
        <span class="nx">getInstanceCount</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
        <span class="nx">getRequestCount</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Concrete Client</span>
    <span class="kr">class</span> <span class="nx">ErrorLogger</span> <span class="kr">implements</span> <span class="nx">Client</span>
    <span class="p">{</span>
        <span class="kr">private</span> <span class="nx">errCodes</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="kr">private</span> <span class="nx">dates</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="kr">private</span> <span class="nx">factory</span><span class="o">:</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">;</span>

        <span class="nx">constructor</span><span class="p">(</span> <span class="nx">factory</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">factory</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">public</span> <span class="nx">log</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span><span class="o">:</span> <span class="k">void</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errCodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">factory</span><span class="p">.</span><span class="nx">make</span><span class="p">(</span> <span class="nx">errCode</span> <span class="p">)</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ErrorLogEntryContext</span><span class="p">(</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="kr">public</span> <span class="nx">printMessages</span><span class="p">()</span><span class="o">:</span> <span class="k">void</span>
        <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">errCodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">logEntry</span><span class="p">,</span> <span class="nx">inx</span> <span class="p">){</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">logEntry</span><span class="p">.</span><span class="nx">getMessage</span><span class="p">(</span> <span class="nx">that</span><span class="p">.</span><span class="nx">dates</span><span class="p">[</span> <span class="nx">inx</span> <span class="p">]</span> <span class="p">)</span> <span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="kr">public</span> <span class="nx">getInstanceCount</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">factory</span><span class="p">.</span><span class="nx">getInstanceCount</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="kr">public</span> <span class="nx">getRequestCount</span><span class="p">()</span><span class="o">:</span> <span class="nx">number</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">factory</span><span class="p">.</span><span class="nx">getRequestCount</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="nx">errorMap</span><span class="p">[</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Insufficient argument type&#39;</span><span class="p">;</span>
<span class="nx">errorMap</span><span class="p">[</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Insufficient argument value&#39;</span><span class="p">;</span>
<span class="nx">errorMap</span><span class="p">[</span> <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Node is undefined&#39;</span><span class="p">;</span>


<span class="cm">/**</span>
<span class="cm"> * Usage</span>
<span class="cm"> */</span>

<span class="nx">logger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ErrorLogger</span><span class="p">(</span> <span class="k">new</span> <span class="nx">ErrorLogEntryFactory</span><span class="p">()</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_VALUE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_INUSUFFICIENT_ARG_TYPE</span> <span class="p">);</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">ERROR_NODE_IS_UNDEFINED</span> <span class="p">);</span>

<span class="nx">logger</span><span class="p">.</span><span class="nx">printMessages</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">logger</span><span class="p">.</span><span class="nx">getRequestCount</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; ErrorLogEntry instances were requested&quot;</span> <span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">logger</span><span class="p">.</span><span class="nx">getInstanceCount</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; LogEntry instances were really created&quot;</span> <span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * Output</span>
<span class="cm"> */</span>

<span class="c1">// Insufficient argument type Wed Apr 03 2013 17:25:24 GMT+0200 (CEST)</span>
<span class="c1">// Insufficient argument type Wed Apr 03 2013 17:25:24 GMT+0200 (CEST)</span>
<span class="c1">// Insufficient argument value Wed Apr 03 2013 17:25:24 GMT+0200 (CEST)</span>
<span class="c1">// Insufficient argument type Wed Apr 03 2013 17:25:24 GMT+0200 (CEST)</span>
<span class="c1">// Node is undefined Wed Apr 03 2013 17:25:24 GMT+0200 (CEST)</span>
<span class="c1">// 5 ErrorLogEntry instances were requested</span>
<span class="c1">// 3 LogEntry instances were really created</span>
</code></pre></div>


    </div>

    <!-- Main docs footer (social buttons, copyright, etc). -->
    <!-- Footer
================================================== -->
<footer class="bs-docs-footer">
  <div class="bs-docs-container">
   MIT licence
  </div>
</footer>

    <!-- JS and analytics only. -->
    <!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.js"></script>
<script src="./assets/js/bootstrap-transition.js"></script>
<script src="./assets/js/bootstrap-alert.js"></script>
<script src="./assets/js/bootstrap-modal.js"></script>
<script src="./assets/js/bootstrap-dropdown.js"></script>
<script src="./assets/js/bootstrap-scrollspy.js"></script>
<script src="./assets/js/bootstrap-tab.js"></script>
<script src="./assets/js/bootstrap-tooltip.js"></script>
<script src="./assets/js/bootstrap-popover.js"></script>
<script src="./assets/js/bootstrap-button.js"></script>
<script src="./assets/js/bootstrap-collapse.js"></script>
<script src="./assets/js/bootstrap-carousel.js"></script>
<script src="./assets/js/bootstrap-typeahead.js"></script>
<script src="./assets/js/bootstrap-affix.js"></script>

<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<script src="./assets/js/holder/holder.js"></script>

<script src="./assets/js/application.js"></script>



  </body>
</html>
